---
phase: 03-landing-site
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/animations/fade-in.tsx
  - src/components/animations/slide-up.tsx
  - src/components/animations/scroll-reveal.tsx
  - src/components/animations/parallax.tsx
  - src/components/animations/staggered-grid.tsx
autonomous: true

must_haves:
  truths:
    - "FadeIn can animate on mount OR on scroll into view"
    - "SlideUp can animate on mount OR on scroll into view"
    - "Parallax component creates smooth scroll-linked Y translation"
    - "StaggeredGrid animates children with configurable stagger delay"
    - "All animations respect once: true by default (no replay on re-enter)"
  artifacts:
    - path: "src/components/animations/fade-in.tsx"
      provides: "Enhanced FadeIn with scroll prop"
      exports: ["FadeIn"]
    - path: "src/components/animations/slide-up.tsx"
      provides: "Enhanced SlideUp with scroll prop"
      exports: ["SlideUp"]
    - path: "src/components/animations/scroll-reveal.tsx"
      provides: "Generic scroll reveal wrapper"
      exports: ["ScrollReveal"]
    - path: "src/components/animations/parallax.tsx"
      provides: "Parallax effect component"
      exports: ["Parallax"]
    - path: "src/components/animations/staggered-grid.tsx"
      provides: "Staggered grid animation"
      exports: ["StaggeredGrid"]
  key_links:
    - from: "src/components/animations/*.tsx"
      to: "motion/react"
      via: "import"
      pattern: "import.*from.*motion/react"
---

<objective>
Extend existing animation components with scroll-trigger support and create new scroll animation primitives.

Purpose: Provide reusable scroll-triggered animations for all landing page sections, enabling pixel-perfect replication of societies.io scroll behaviors.

Output: Enhanced FadeIn/SlideUp with scroll prop, new ScrollReveal, Parallax, and StaggeredGrid components.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/03-landing-site/03-RESEARCH.md
@src/components/animations/fade-in.tsx
@src/components/animations/slide-up.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance FadeIn and SlideUp with scroll triggers</name>
  <files>
    src/components/animations/fade-in.tsx
    src/components/animations/slide-up.tsx
  </files>
  <action>
    Update existing animation components to support both mount and scroll-triggered animations.

    **FadeIn Enhancement** (src/components/animations/fade-in.tsx):
    ```typescript
    "use client"

    import { motion } from "motion/react"
    import { ReactNode } from "react"

    interface FadeInProps {
      children: ReactNode
      delay?: number
      duration?: number
      className?: string
      /** If true, animates when scrolled into view. If false, animates on mount. */
      scroll?: boolean
      /** Viewport amount threshold (0-1). Default 0.3 */
      threshold?: number
    }

    export function FadeIn({
      children,
      delay = 0,
      duration = 0.5,
      className,
      scroll = false,
      threshold = 0.3,
    }: FadeInProps) {
      const animationProps = scroll
        ? {
            initial: { opacity: 0, y: 20 },
            whileInView: { opacity: 1, y: 0 },
            viewport: { once: true, amount: threshold },
          }
        : {
            initial: { opacity: 0, y: 20 },
            animate: { opacity: 1, y: 0 },
          }

      return (
        <motion.div
          {...animationProps}
          transition={{
            duration,
            delay,
            ease: [0.4, 0, 0.2, 1],
          }}
          className={className}
        >
          {children}
        </motion.div>
      )
    }
    ```

    **SlideUp Enhancement** (src/components/animations/slide-up.tsx):
    Apply same pattern - add scroll and threshold props, use whileInView when scroll=true.
    Keep existing ease curve [0.22, 1, 0.36, 1] and distance prop.
  </action>
  <verify>
    - npm run build succeeds
    - FadeIn accepts scroll prop
    - SlideUp accepts scroll prop
    - Both components export correctly
  </verify>
  <done>
    FadeIn and SlideUp support both mount animation (default) and scroll-triggered animation (scroll=true).
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ScrollReveal, Parallax, and StaggeredGrid components</name>
  <files>
    src/components/animations/scroll-reveal.tsx
    src/components/animations/parallax.tsx
    src/components/animations/staggered-grid.tsx
    src/components/animations/index.ts
  </files>
  <action>
    Create new animation components following RESEARCH.md patterns.

    **ScrollReveal** (src/components/animations/scroll-reveal.tsx):
    Generic scroll reveal wrapper with configurable animation:
    ```typescript
    "use client"

    import { motion, Variants } from "motion/react"
    import { ReactNode } from "react"

    interface ScrollRevealProps {
      children: ReactNode
      className?: string
      variants?: Variants
      delay?: number
      duration?: number
      threshold?: number
    }

    const defaultVariants: Variants = {
      hidden: { opacity: 0, y: 40 },
      visible: { opacity: 1, y: 0 },
    }

    export function ScrollReveal({
      children,
      className,
      variants = defaultVariants,
      delay = 0,
      duration = 0.6,
      threshold = 0.3,
    }: ScrollRevealProps) {
      return (
        <motion.div
          initial="hidden"
          whileInView="visible"
          viewport={{ once: true, amount: threshold }}
          variants={variants}
          transition={{ duration, delay, ease: [0.22, 1, 0.36, 1] }}
          className={className}
        >
          {children}
        </motion.div>
      )
    }
    ```

    **Parallax** (src/components/animations/parallax.tsx):
    Scroll-linked parallax effect:
    ```typescript
    "use client"

    import { motion, useScroll, useTransform } from "motion/react"
    import { ReactNode, useRef } from "react"

    interface ParallaxProps {
      children: ReactNode
      className?: string
      /** Parallax intensity. Positive = moves up, negative = moves down. Default 30 */
      intensity?: number
      /** Element to use as scroll container reference */
      containerRef?: React.RefObject<HTMLElement>
    }

    export function Parallax({
      children,
      className,
      intensity = 30,
      containerRef,
    }: ParallaxProps) {
      const ref = useRef<HTMLDivElement>(null)
      const { scrollYProgress } = useScroll({
        target: ref,
        offset: ["start end", "end start"],
        ...(containerRef && { container: containerRef }),
      })

      const y = useTransform(scrollYProgress, [0, 1], [`${intensity}%`, `-${intensity}%`])

      return (
        <motion.div ref={ref} style={{ y }} className={className}>
          {children}
        </motion.div>
      )
    }
    ```

    **StaggeredGrid** (src/components/animations/staggered-grid.tsx):
    For feature grids, team sections:
    ```typescript
    "use client"

    import { motion } from "motion/react"
    import { ReactNode, Children } from "react"

    interface StaggeredGridProps {
      children: ReactNode
      className?: string
      /** Delay between each child animation. Default 0.1s */
      staggerDelay?: number
      /** Animation duration per child. Default 0.5s */
      duration?: number
      threshold?: number
    }

    export function StaggeredGrid({
      children,
      className,
      staggerDelay = 0.1,
      duration = 0.5,
      threshold = 0.2,
    }: StaggeredGridProps) {
      return (
        <motion.div
          initial="hidden"
          whileInView="visible"
          viewport={{ once: true, amount: threshold }}
          variants={{
            visible: {
              transition: {
                staggerChildren: staggerDelay,
              },
            },
          }}
          className={className}
        >
          {Children.map(children, (child, index) => (
            <motion.div
              key={index}
              variants={{
                hidden: { opacity: 0, y: 30 },
                visible: { opacity: 1, y: 0 },
              }}
              transition={{ duration, ease: [0.22, 1, 0.36, 1] }}
            >
              {child}
            </motion.div>
          ))}
        </motion.div>
      )
    }
    ```

    **Index Export** (src/components/animations/index.ts):
    Create barrel export for all animation components:
    ```typescript
    export { FadeIn } from "./fade-in"
    export { SlideUp } from "./slide-up"
    export { ScrollReveal } from "./scroll-reveal"
    export { Parallax } from "./parallax"
    export { StaggeredGrid } from "./staggered-grid"
    export { PageTransition } from "./page-transition"
    ```
  </action>
  <verify>
    - npm run build succeeds
    - All new components export from index.ts
    - No TypeScript errors
    - Imports from "motion/react" are correct (not "framer-motion")
  </verify>
  <done>
    ScrollReveal, Parallax, and StaggeredGrid components created with proper TypeScript interfaces, barrel export updated.
  </done>
</task>

</tasks>

<verification>
1. npm run build completes without errors
2. All animation components export from src/components/animations/index.ts
3. FadeIn scroll=true triggers animation on viewport enter
4. SlideUp scroll=true triggers animation on viewport enter
5. Parallax creates smooth scroll-linked movement
6. StaggeredGrid animates children in sequence
</verification>

<success_criteria>
- All animation components work with scroll triggers
- No TypeScript errors
- Components are ready for use in landing page sections
- Animations only play once (viewport.once = true)
</success_criteria>

<output>
After completion, create `.planning/phases/03-landing-site/03-02-SUMMARY.md`
</output>
