---
phase: 56-earnings-tab
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/app/brand-deals/earnings-period-selector.tsx
  - src/components/app/brand-deals/earnings-chart.tsx
autonomous: true

must_haves:
  truths:
    - "Area chart renders with coral/orange gradient fill visible on dark background"
    - "Chart has dark-mode themed axes, labels, and horizontal grid lines"
    - "Hovering the chart shows a solid dark tooltip with formatted date and earnings value"
    - "Period selector renders four pills (7D, 30D, 90D, All Time) with sliding pill animation"
  artifacts:
    - path: "src/components/app/brand-deals/earnings-period-selector.tsx"
      provides: "Period selector with sliding pill animation"
      exports: ["EarningsPeriodSelector", "Period"]
    - path: "src/components/app/brand-deals/earnings-chart.tsx"
      provides: "Recharts AreaChart with coral gradient and dark theming"
      exports: ["EarningsChart"]
  key_links:
    - from: "src/components/app/brand-deals/earnings-period-selector.tsx"
      to: "src/components/app/brand-deals/brand-deals-tabs.tsx"
      via: "Reuses motion layoutId sliding pill pattern"
      pattern: "layoutId"
    - from: "src/components/app/brand-deals/earnings-chart.tsx"
      to: "src/lib/affiliate-utils.ts"
      via: "import formatCurrency for tooltip"
      pattern: "formatCurrency"
---

<objective>
Build the EarningsPeriodSelector and EarningsChart components -- the sliding pill period selector and the dark-themed Recharts area chart with coral/orange gradient fill and solid dark tooltip.

Purpose: Delivers EARN-04 (period selector), EARN-05 (dark-themed chart), EARN-06 (coral gradient fill), EARN-07 (solid dark tooltip) as presentational components ready for the EarningsTab container.
Output: Two files -- period selector and chart components.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/56-earnings-tab/56-RESEARCH.md

@src/components/app/brand-deals/brand-deals-tabs.tsx
@src/lib/affiliate-utils.ts
@src/types/brand-deals.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create EarningsPeriodSelector component</name>
  <files>src/components/app/brand-deals/earnings-period-selector.tsx</files>
  <action>
Create the period selector component at `src/components/app/brand-deals/earnings-period-selector.tsx`.

1. `"use client"` directive
2. Define and export `type Period = "7d" | "30d" | "90d" | "all"`
3. Define `PERIODS` array: `[{ value: "7d", label: "7D" }, { value: "30d", label: "30D" }, { value: "90d", label: "90D" }, { value: "all", label: "All Time" }]`
4. Props interface:
   ```typescript
   interface EarningsPeriodSelectorProps {
     activePeriod: Period;
     onPeriodChange: (period: Period) => void;
   }
   ```
5. Reuse the sliding pill pattern from `BrandDealsTabs`:
   - Container: `inline-flex items-center gap-1 rounded-full border border-border-subtle bg-surface-elevated/50 p-1`
   - Each button: `relative rounded-full px-3 py-1.5 text-xs font-medium outline-none transition-colors`
   - Active pill: `<motion.div layoutId="earnings-period-pill" className="absolute inset-0 z-0 rounded-full border border-white/10 bg-white/10" transition={{ type: "spring", stiffness: 400, damping: 30 }} />`
   - Text: `relative z-10`, active = `text-foreground`, inactive = `text-foreground-muted hover:text-foreground-secondary`
6. IMPORTANT: Use a DIFFERENT `layoutId` from the main tabs (`"earnings-period-pill"`, not `"brand-deals-tab-pill"`) to avoid animation conflict
7. Import `motion` from `motion/react`
8. Add `focus-visible:ring-2 focus-visible:ring-accent` on buttons for keyboard a11y
  </action>
  <verify>
Run `npx tsc --noEmit` to verify no type errors. Verify the component exports `EarningsPeriodSelector` and `Period` type.
  </verify>
  <done>
`EarningsPeriodSelector` renders four period pills (7D, 30D, 90D, All Time) with a smooth sliding pill animation using motion `layoutId`, matching the BrandDealsTabs pattern but with its own unique `layoutId`. Calls `onPeriodChange` when a pill is clicked.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create EarningsChart component with coral gradient and dark tooltip</name>
  <files>src/components/app/brand-deals/earnings-chart.tsx</files>
  <action>
Create the earnings chart component at `src/components/app/brand-deals/earnings-chart.tsx`.

1. `"use client"` directive
2. Import from `recharts`: `AreaChart`, `Area`, `XAxis`, `YAxis`, `CartesianGrid`, `Tooltip`, `ResponsiveContainer`, and `TooltipProps`
3. Import `formatCurrency` from `@/lib/affiliate-utils`
4. Import `MonthlyEarning` type from `@/types/brand-deals`

**Props interface:**
```typescript
interface EarningsChartProps {
  data: MonthlyEarning[];
}
```

**EarningsTooltip internal component (not exported):**
A custom Recharts tooltip with SOLID opaque dark background (NOT glassmorphic):
```
function EarningsTooltip({ active, payload, label }: TooltipProps<number, string>)
```
- If `!active || !payload?.length` return null
- Render a `<div>` with:
  - `className="rounded-lg border border-white/[0.08] px-3 py-2"`
  - `style={{ background: "#222326", boxShadow: "rgba(255,255,255,0.1) 0 1px 0 0 inset, 0 4px 12px rgba(0,0,0,0.5)" }}`
  - Top line: `<p className="text-xs text-foreground-muted">{label}</p>` -- shows month
  - Bottom line: `<p className="text-sm font-semibold text-foreground">{formatCurrency(payload[0].value ?? 0)}</p>` -- shows formatted amount
- NO backdrop-filter, NO blur. Solid opaque as per CONTEXT.md decision.

**EarningsChart component:**

Renders the Recharts AreaChart:
- `<ResponsiveContainer width="100%" height={300}>`
- Inside `<AreaChart>` with `data={data}` and `margin={{ top: 10, right: 10, left: 10, bottom: 0 }}`
- SVG gradient definition:
  ```
  <defs>
    <linearGradient id="earnings-area-gradient" x1="0" y1="0" x2="0" y2="1">
      <stop offset="5%" stopColor="#FF7F50" stopOpacity={0.3} />
      <stop offset="95%" stopColor="#FF7F50" stopOpacity={0.02} />
    </linearGradient>
  </defs>
  ```
- `<CartesianGrid horizontal={true} vertical={false} stroke="rgba(255, 255, 255, 0.04)" />`
- `<XAxis dataKey="month" tick={{ fill: "rgba(255, 255, 255, 0.4)", fontSize: 12 }} axisLine={{ stroke: "rgba(255, 255, 255, 0.06)" }} tickLine={false} />`
- `<YAxis tick={{ fill: "rgba(255, 255, 255, 0.4)", fontSize: 12 }} axisLine={false} tickLine={false} tickFormatter={(v: number) => \`$${(v / 1000).toFixed(1)}K\`} width={50} />`
- `<Tooltip content={<EarningsTooltip />} cursor={false} />`
- `<Area type="monotone" dataKey="amount" stroke="#FF7F50" strokeWidth={2} fillOpacity={1} fill="url(#earnings-area-gradient)" animationDuration={1000} />`

Use a unique, descriptive gradient ID (`earnings-area-gradient`) to avoid SVG ID collisions (see RESEARCH.md Pitfall 2).

Set YAxis `width={50}` to prevent dollar value label clipping (RESEARCH.md Pitfall 5).
  </action>
  <verify>
Run `npx tsc --noEmit` to verify no type errors. Verify the component exports `EarningsChart` and `EarningsChartProps`.
  </verify>
  <done>
`EarningsChart` renders a Recharts AreaChart with coral/orange gradient fill (#FF7F50), dark-themed axes (white/0.4 tick fills, white/0.06 axis lines), subtle horizontal grid lines (white/0.04), a solid dark tooltip (opaque #222326 bg, no blur) showing formatted month and currency value, and responsive sizing. Chart animates on mount over 1 second.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `EarningsPeriodSelector` renders four pills with sliding pill animation
3. `EarningsChart` renders an area chart with coral gradient visible on dark background
4. Chart tooltip shows formatted currency value on hover with solid dark background
5. Chart has visible axes, labels, and horizontal grid lines on dark background
6. Period selector uses unique layoutId to avoid conflict with main tab pills
</verification>

<success_criteria>
- Period selector shows four pills (7D, 30D, 90D, All Time) with animated sliding indicator
- Area chart renders with coral/orange gradient fill visible on the dark #07080a background
- Chart is dark-mode themed: white/0.4 axis labels, white/0.06 axis lines, white/0.04 grid lines
- Tooltip is solid dark (#222326 background, no blur) showing month and formatted earnings
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/56-earnings-tab/56-02-SUMMARY.md`
</output>
