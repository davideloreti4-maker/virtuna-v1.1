---
phase: 06-polish
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/(app)/dashboard/dashboard-client.tsx
  - src/app/(app)/trending/page.tsx
  - src/app/(app)/referrals/page.tsx
  - src/app/(app)/settings/page.tsx
  - src/app/(marketing)/page.tsx
  - src/components/app/simulation/loading-phases.tsx
  - src/components/ui/button.tsx
  - src/components/ui/card.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "All app pages use responsive patterns (no fixed widths without overflow handling, no sub-44px touch targets)"
    - "Dashboard skeleton loading uses Zustand-driven progressive reveal (intentional mock delays documented, not a Suspense bug)"
    - "Dashboard card components follow Raycast design system (bg-transparent, border-white/[0.06], inset shadow)"
    - "Primary buttons use shadow-button token correctly (4-layer shadow defined in globals.css)"
    - "Trending page placeholder renders correctly on mobile viewports (320-768px)"
  artifacts:
    - path: "src/app/(app)/trending/page.tsx"
      provides: "Mobile-safe placeholder page"
      contains: "flex.*items-center"
    - path: "src/components/ui/card.tsx"
      provides: "Raycast-compliant Card and GlassCard"
      contains: "bg.*transparent"
    - path: "src/components/ui/button.tsx"
      provides: "Accessible buttons with shadow-button token"
      contains: "shadow-button"
  key_links:
    - from: "src/stores/test-store.ts"
      to: "src/components/app/simulation/loading-phases.tsx"
      via: "Zustand simulationPhase state"
      pattern: "simulationPhase"
    - from: "src/components/ui/card.tsx"
      to: "src/app/globals.css"
      via: "Design tokens (border-border, bg-transparent)"
      pattern: "border-border"
---

<objective>
Close 3 verification gaps from Phase 6 by auditing all pages for mobile-hostile CSS patterns (fixed widths, small touch targets, missing overflow handling) and verifying that dashboard skeleton delays, card backgrounds, and button shadows are already compliant with the design system.

Purpose: The verification found these items unverified, not broken. This plan systematically audits the code, fixes any real issues found, and documents compliance for items that are already correct.

Output: Any mobile CSS fixes applied + verification that PLSH-01 items (skeleton delays, card backgrounds, button shadows) are design-system compliant.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-polish/06-01-SUMMARY.md
@.planning/phases/06-polish/06-02-SUMMARY.md
@.planning/phases/06-polish/06-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Audit and fix mobile-hostile CSS patterns across all pages</name>
  <files>
    src/app/(app)/dashboard/dashboard-client.tsx
    src/app/(app)/trending/page.tsx
    src/app/(app)/referrals/page.tsx
    src/app/(app)/settings/page.tsx
    src/app/(marketing)/page.tsx
    src/components/app/simulation/loading-phases.tsx
  </files>
  <action>
    Systematically audit all app and marketing pages for mobile-hostile CSS patterns. For each page, check:

    1. **Fixed widths without overflow handling** — Search for `w-[Npx]`, `min-w-[Npx]` without a parent `overflow-x-auto`. The pricing table's `min-w-[480px]` inside `overflow-x-auto` is acceptable (documented horizontal scroll pattern).

    2. **Touch targets below 44px** — Check interactive elements (buttons, links, tab triggers) have `min-h-[44px]` or equivalent height. The Button component already enforces this via size variants (sm=36px for icon buttons, md=44px, lg=48px). Settings tab triggers already have `min-h-[44px]`.

    3. **Missing flex constraints** — Ensure flex children that could grow have `min-w-0` or `overflow-hidden` to prevent overflow. Dashboard filter pills already have `min-w-0` (06-01 fix).

    4. **Absolute-positioned content on short mobile screens** — Dashboard's floating content area (`absolute bottom-6 left-1/2 max-w-2xl px-6`) should have `max-h` with overflow-y-auto to handle very short mobile viewports where the form might extend beyond the viewport.

    **Pages to verify (in order):**

    - `src/app/(app)/trending/page.tsx` — Simple placeholder: `flex min-h-screen flex-col items-center justify-center px-4`. Expected: already mobile-safe. Verify and move on.

    - `src/app/(app)/referrals/page.tsx` — Layout: `max-w-4xl mx-auto px-4 py-6 sm:p-6 space-y-6`. Expected: already responsive with `px-4` base padding. Verify ReferralLinkCard and ReferralStatsCard don't have fixed widths.

    - `src/app/(app)/settings/page.tsx` → `settings-page.tsx` — Tabs are `overflow-x-auto` horizontally on mobile, `flex-col md:flex-row` layout, content has `min-w-0`. Expected: already responsive. Verify tab triggers have 44px min touch targets (they do: `min-h-[44px]`).

    - `src/app/(app)/dashboard/dashboard-client.tsx` — Filter pills already fixed (min-w-0). Check the floating content area at bottom for short mobile viewports. If form content could overflow below viewport, add `max-h-[70vh] overflow-y-auto` to the floating container.

    - `src/app/(marketing)/page.tsx` — Composed of section components. Verify HeroSection, FeaturesSection, StatsSection, SocialProofSection, FAQSection use responsive Tailwind classes (sm:/md:/lg: breakpoints). These were built mobile-first in Phase 2.

    - `src/components/app/simulation/loading-phases.tsx` — Verify skeleton cards don't use fixed pixel widths that would overflow on mobile. The GlassSkeleton uses `width="120px"` etc. but these are small values that won't cause overflow on 320px screens.

    **Fix any issues found.** If everything is already compliant (likely based on code review), document that the audit passed with no changes needed.
  </action>
  <verify>
    Run `npx tsc --noEmit` to confirm no type errors if any files were modified. Grep for mobile-hostile patterns: `grep -rn 'w-\[.*px\]' src/app/ --include='*.tsx'` and verify each result has overflow handling or is small enough (< 320px).
  </verify>
  <done>
    All pages audited for mobile-hostile patterns. Any fixed-width elements without overflow handling are either fixed or documented as acceptable (e.g., pricing table with overflow-x-auto). Touch targets verified >= 44px on interactive elements. Dashboard floating content area handles short viewports.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify and document PLSH-01 compliance (skeleton delays, card backgrounds, button shadows)</name>
  <files>
    src/stores/test-store.ts
    src/components/app/simulation/loading-phases.tsx
    src/components/ui/card.tsx
    src/components/ui/button.tsx
    src/app/globals.css
    src/components/app/auth-guard.tsx
  </files>
  <action>
    Verify three PLSH-01 items that the verification flagged as "not systematically verified." These are VERIFICATION gaps, not code bugs. Confirm compliance and document:

    **1. Skeleton delays / loading states:**

    Read `src/stores/test-store.ts` — The `submitTest` method uses four `setTimeout(resolve, 1000)` calls. These simulate AI backend processing phases (analyzing → matching → simulating → generating). They are INTENTIONAL mock delays for the demo. The real backend doesn't exist yet. These are NOT loading state bugs and do NOT need Suspense replacement.

    Read `src/components/app/simulation/loading-phases.tsx` — The `LoadingPhases` component reads `simulationPhase` from Zustand and progressively reveals skeleton sections as each phase activates. This is a proper state-driven progressive loading pattern, not hardcoded timers in the UI layer.

    Read `src/components/app/auth-guard.tsx` — The `AuthGuard` uses `useState(isLoading)` with an async `getSession()` check. This is a standard auth verification pattern. Replacing with Suspense would require making the auth check a server-side boundary, which is already handled by middleware. The client-side guard is a safety net, not a data-fetching layer. No change needed.

    **Conclusion:** Skeleton delays are intentional mock backend simulation. Loading states are state-driven (Zustand), not hardcoded UI timers. AuthGuard loading is a standard auth check pattern. All compliant — no changes needed.

    **2. Card backgrounds:**

    Read `src/components/ui/card.tsx` — Verify `Card` uses `background: "transparent"` + `border border-border rounded-[12px]` + `boxShadow: "rgba(255, 255, 255, 0.05) 0px 1px 0px 0px inset"`. Compare against Brand Bible: cards should be `bg-transparent`, `border rgba(255,255,255,0.06)`, `border-radius: 12px`, inset shadow `rgba(255,255,255,0.05) 0 1px 0 0 inset`.

    Check: `border-border` resolves to `rgba(255,255,255,0.06)` (verify in globals.css). If yes, Card is fully compliant.

    Also verify `GlassCard` follows the same border pattern with added glassmorphism.

    **Conclusion:** Card component follows Raycast design system. No changes needed unless border-border token doesn't resolve to 6% white (verify and fix if needed).

    **3. Button shadows:**

    Read `src/components/ui/button.tsx` — Primary variant uses `shadow-button`. Read `src/app/globals.css` — `--shadow-button` is defined as the 4-layer shadow: `rgba(0, 0, 0, 0.5) 0px 0px 0px 2px, rgba(255, 255, 255, 0.19) 0px 0px 14px 0px, rgba(0, 0, 0, 0.2) 0px -1px 0.4px 0px inset, rgba(255, 255, 255, 0.2) 0px 1px 0.4px 0px inset`.

    Compare against Brand Bible: Primary buttons should have `shadow-button` (4-layer). Secondary buttons should be `bg-transparent border-white/[0.06]` hover `bg-white/[0.1]`.

    Verify secondary variant in button.tsx: `bg-transparent border border-white/[0.06] text-foreground hover:bg-white/[0.1]`. This matches exactly.

    **Conclusion:** Button shadows match Brand Bible. No changes needed.

    **If all three items are compliant, no code changes are needed for this task.** The deliverable is the verification documentation in the SUMMARY, confirming these items are design-system compliant and not bugs.
  </action>
  <verify>
    Grep to confirm: (1) `grep "shadow-button" src/app/globals.css` shows 4-layer shadow, (2) `grep "transparent" src/components/ui/card.tsx` shows bg-transparent, (3) `grep "simulationPhase" src/components/app/simulation/loading-phases.tsx` shows state-driven loading. All three patterns present = compliant.
  </verify>
  <done>
    PLSH-01 items verified as design-system compliant: (1) skeleton delays are intentional mock backend simulation driven by Zustand state, (2) card backgrounds use bg-transparent + border-border + correct inset shadow, (3) button shadows use shadow-button 4-layer token. No code changes needed — these were verification gaps, not code bugs.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes (no broken types from any mobile fixes)
2. All pages audited for: fixed widths > 320px without overflow, touch targets < 44px, missing flex constraints
3. Dashboard skeleton delays confirmed as intentional mock simulation (not Suspense candidates)
4. Card component confirmed as Raycast-compliant (bg-transparent, border 6%, inset shadow 5%)
5. Button shadow-button token confirmed as 4-layer shadow matching Brand Bible
6. Trending page confirmed mobile-safe (simple flex placeholder)
</verification>

<success_criteria>
- Zero mobile-hostile patterns found (or all found patterns fixed)
- PLSH-01 items (skeleton, cards, buttons) documented as compliant with design system
- PLSH-04 mobile responsiveness audit completed across all pages
- Success criteria #6 (trending page mobile) verified as passing
- `npx tsc --noEmit` passes
</success_criteria>

<output>
After completion, create `.planning/phases/06-polish/06-03-SUMMARY.md`
</output>
