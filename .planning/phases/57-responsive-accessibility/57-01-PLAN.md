---
phase: 57-responsive-accessibility
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/app/brand-deals/deals-tab-skeleton.tsx
  - src/components/app/brand-deals/affiliates-tab-skeleton.tsx
  - src/components/app/brand-deals/earnings-tab-skeleton.tsx
  - src/components/app/brand-deals/deals-tab.tsx
  - src/components/app/brand-deals/affiliates-tab.tsx
  - src/components/app/brand-deals/earnings-tab.tsx
  - src/components/app/brand-deals/brand-deals-page.tsx
  - src/components/app/brand-deals/brand-deals-header.tsx
  - src/components/app/brand-deals/earnings-breakdown-list.tsx
autonomous: true

must_haves:
  truths:
    - "Each tab shows a shimmer skeleton matching its content layout before data appears"
    - "Deals skeleton shows filter bar shape + 3-column card grid shape"
    - "Affiliates skeleton shows two-section layout (active links + available products)"
    - "Earnings skeleton shows 2x2 stat cards + chart area + breakdown list shape"
    - "Page container uses p-4 on mobile, p-6 on sm+"
    - "Header stats wrap or stack on screens narrower than sm breakpoint"
    - "Earnings breakdown list hides Clicks and Conversions columns on mobile (shows Source + Earnings only)"
    - "Skeleton shimmer respects prefers-reduced-motion (existing Skeleton primitive handles this)"
  artifacts:
    - path: "src/components/app/brand-deals/deals-tab-skeleton.tsx"
      provides: "Skeleton matching DealsTab layout"
      exports: ["DealsTabSkeleton"]
    - path: "src/components/app/brand-deals/affiliates-tab-skeleton.tsx"
      provides: "Skeleton matching AffiliatesTab layout"
      exports: ["AffiliatesTabSkeleton"]
    - path: "src/components/app/brand-deals/earnings-tab-skeleton.tsx"
      provides: "Skeleton matching EarningsTab layout"
      exports: ["EarningsTabSkeleton"]
  key_links:
    - from: "src/components/app/brand-deals/deals-tab.tsx"
      to: "src/components/app/brand-deals/deals-tab-skeleton.tsx"
      via: "isLoading state -> conditional render"
      pattern: "isLoading.*DealsTabSkeleton"
    - from: "src/components/app/brand-deals/affiliates-tab.tsx"
      to: "src/components/app/brand-deals/affiliates-tab-skeleton.tsx"
      via: "isLoading state -> conditional render"
      pattern: "isLoading.*AffiliatesTabSkeleton"
    - from: "src/components/app/brand-deals/earnings-tab.tsx"
      to: "src/components/app/brand-deals/earnings-tab-skeleton.tsx"
      via: "isLoading state -> conditional render"
      pattern: "isLoading.*EarningsTabSkeleton"
---

<objective>
Create skeleton loading states for all three tabs and fix responsive layout gaps for mobile viewports.

Purpose: Skeletons demonstrate polished loading UX matching actual content shapes. Responsive fixes ensure the page works on mobile (header stats, earnings breakdown table, page container padding).

Output: Three skeleton components, loading integration in each tab container, and responsive CSS fixes on header/breakdown/page.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/phases/57-responsive-accessibility/57-RESEARCH.md

Key source files (read before editing):
@src/components/ui/skeleton.tsx
@src/components/app/brand-deals/deals-tab.tsx
@src/components/app/brand-deals/affiliates-tab.tsx
@src/components/app/brand-deals/earnings-tab.tsx
@src/components/app/brand-deals/brand-deals-page.tsx
@src/components/app/brand-deals/brand-deals-header.tsx
@src/components/app/brand-deals/earnings-breakdown-list.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create skeleton components for all three tabs</name>
  <files>
    src/components/app/brand-deals/deals-tab-skeleton.tsx
    src/components/app/brand-deals/affiliates-tab-skeleton.tsx
    src/components/app/brand-deals/earnings-tab-skeleton.tsx
  </files>
  <action>
Create three skeleton components using the existing `Skeleton` primitive from `@/components/ui/skeleton`. Each skeleton MUST mirror the exact layout structure and grid classes of its corresponding tab content.

**DealsTabSkeleton:**
- Section 1: "New This Week" row skeleton -- `mb-6` wrapper, `h-6 w-40` heading skeleton, flex row with 3x `h-[200px] w-[300px] shrink-0 rounded-xl` skeleton cards
- Section 2: Filter bar skeleton -- `h-[42px] w-full max-w-sm rounded-lg` search input skeleton, flex-wrap row with 6x `h-7 w-16 rounded-full` filter pill skeletons
- Section 3: Deal grid skeleton -- MUST use same responsive grid: `grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3` with 6x `h-[200px] rounded-xl` card skeletons
- Wrap entire component in `<div aria-hidden="true">`
- No "use client" needed (no hooks, pure JSX)

**AffiliatesTabSkeleton:**
- Section 1: Active Links -- heading skeleton `h-5 w-28` + badge `h-5 w-8 rounded-full`, grid `grid-cols-1 gap-4 sm:grid-cols-2` with 4x `h-[180px] rounded-xl` card skeletons
- Section 2: Available Products -- heading skeleton `h-5 w-36`, grid `grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3` with 3x `h-[200px] rounded-xl` card skeletons
- `space-y-8` outer wrapper matching AffiliatesTab layout. Wrap in `<div aria-hidden="true">`

**EarningsTabSkeleton:**
- Section 1: Stat cards `grid-cols-2 gap-4` with 4x skeleton cards (each: `rounded-xl border border-border bg-surface-elevated p-5` wrapper containing `h-4 w-24` label + `h-7 w-32` value + `h-3 w-16` change indicator skeletons)
- Section 2: Chart area -- flex row with `h-4 w-32` heading + `h-8 w-48 rounded-full` period selector skeleton, then `h-[300px] rounded-xl` chart skeleton
- Section 3: Breakdown -- `h-4 w-36` heading + `h-[280px] rounded-xl` table skeleton
- `space-y-6` outer wrapper matching EarningsTab layout. Wrap in `<div aria-hidden="true">`
  </action>
  <verify>
Run `npx tsc --noEmit` -- no TypeScript errors. All three skeleton files import Skeleton correctly and export named functions.
  </verify>
  <done>
Three skeleton components exist, each matching the layout shape, grid breakpoints, and spacing of their corresponding tab content. All use the existing Skeleton primitive.
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate loading states and fix responsive gaps</name>
  <files>
    src/components/app/brand-deals/deals-tab.tsx
    src/components/app/brand-deals/affiliates-tab.tsx
    src/components/app/brand-deals/earnings-tab.tsx
    src/components/app/brand-deals/brand-deals-page.tsx
    src/components/app/brand-deals/brand-deals-header.tsx
    src/components/app/brand-deals/earnings-breakdown-list.tsx
  </files>
  <action>
**Loading state integration -- add to each tab container:**

In `deals-tab.tsx`, `affiliates-tab.tsx`, and `earnings-tab.tsx`:
1. Add `useEffect` to imports (already imported in some)
2. Add at the top of the component function:
   ```tsx
   const [isLoading, setIsLoading] = useState(true);
   useEffect(() => {
     const timer = setTimeout(() => setIsLoading(false), 800);
     return () => clearTimeout(timer);
   }, []);
   ```
3. Add early return before the main JSX:
   ```tsx
   if (isLoading) return <DealsTabSkeleton />;
   ```
   (Use the corresponding skeleton component for each tab)
4. Import the skeleton component from the relative path

**Responsive fixes:**

In `brand-deals-page.tsx`:
- Change `p-6` to `p-4 sm:p-6` on the outer `<div className="mx-auto max-w-5xl">` wrapper

In `brand-deals-header.tsx`:
- On the inner stats container (line 54, `<div className="flex items-center gap-0">`), add `flex-wrap gap-y-2` so stats wrap on narrow screens instead of overflowing
- Change `gap-0` to `gap-y-2` to give vertical spacing when wrapped

In `earnings-breakdown-list.tsx`:
- On BOTH the header row AND each data row, change `grid-cols-4` to `grid-cols-2 sm:grid-cols-4`
- On the Clicks column header and data: add `hidden sm:block` to hide on mobile
- On the Conversions column header and data: add `hidden sm:block` to hide on mobile
- The Source and Earnings columns remain visible at all breakpoints
  </action>
  <verify>
1. `npx tsc --noEmit` passes with no errors
2. `npm run build` succeeds (or `pnpm build`)
3. Verify in browser: navigate to /brand-deals -- each tab shows skeleton for ~800ms before content
4. Resize browser to 375px width -- header stats should wrap, deals grid should be 1 column, earnings breakdown shows only Source + Earnings columns
  </verify>
  <done>
All three tabs display skeleton loading states for 800ms before content renders. Page uses responsive padding (p-4 mobile, p-6 sm+). Header stats wrap on narrow screens. Earnings breakdown hides middle columns on mobile, showing only Source and Earnings.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` -- zero TypeScript errors
2. `npm run build` (or `pnpm build`) -- build succeeds
3. Open /brand-deals in browser at desktop width -- each tab shows matching skeleton for ~800ms, then content fades in
4. Open /brand-deals at 375px mobile width:
   - Header stats wrap into rows (no horizontal overflow)
   - Deals grid is single column
   - Affiliates cards stack vertically
   - Earnings breakdown shows only Source + Earnings (Clicks/Conversions hidden)
   - Page has 16px padding (not 24px)
5. Skeletons use same grid classes as real content (no layout shift when content replaces skeleton)
</verification>

<success_criteria>
- Three skeleton components exist and match their tab content shapes
- Loading skeleton renders for ~800ms on each tab mount
- Responsive layout works at 375px viewport: no overflow, proper stacking, hidden mobile columns
- `npx tsc --noEmit` and build both pass
</success_criteria>

<output>
After completion, create `.planning/phases/57-responsive-accessibility/57-01-SUMMARY.md`
</output>
