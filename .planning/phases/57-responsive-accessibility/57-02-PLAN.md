---
phase: 57-responsive-accessibility
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/app/brand-deals/deal-card.tsx
  - src/components/app/brand-deals/available-product-card.tsx
  - src/components/app/brand-deals/affiliate-link-card.tsx
  - src/components/primitives/GlassPill.tsx
  - src/components/app/brand-deals/earnings-period-selector.tsx
autonomous: true

must_haves:
  truths:
    - "User can Tab through all deal cards and the focus ring is visible"
    - "Pressing Enter on a focused DealCard triggers the Apply action (unless applied or expired)"
    - "User can Tab through available product cards with visible focus ring"
    - "Pressing Enter on a focused AvailableProductCard triggers Generate Link"
    - "Affiliate link cards have visible focus ring when focused via keyboard"
    - "GlassPill filter buttons show focus-visible ring when tabbed to"
    - "EarningsPeriodSelector has role=radiogroup with aria-label, each button has role=radio and aria-checked"
    - "All focus rings use the design system accent color (focus-visible:ring-accent)"
  artifacts:
    - path: "src/components/app/brand-deals/deal-card.tsx"
      provides: "Keyboard-accessible deal card"
      contains: "tabIndex={0}"
    - path: "src/components/app/brand-deals/available-product-card.tsx"
      provides: "Keyboard-accessible product card"
      contains: "tabIndex={0}"
    - path: "src/components/app/brand-deals/affiliate-link-card.tsx"
      provides: "Keyboard-accessible affiliate card"
      contains: "tabIndex={0}"
    - path: "src/components/primitives/GlassPill.tsx"
      provides: "Focus-visible ring on interactive GlassPill"
      contains: "focus-visible:ring-2"
    - path: "src/components/app/brand-deals/earnings-period-selector.tsx"
      provides: "ARIA radiogroup semantics on period selector"
      contains: "role=\"radiogroup\""
  key_links:
    - from: "DealCard div"
      to: "onApply callback"
      via: "onKeyDown Enter handler"
      pattern: "onKeyDown.*Enter.*onApply"
    - from: "AvailableProductCard div"
      to: "onGenerateLink callback"
      via: "onKeyDown Enter handler"
      pattern: "onKeyDown.*Enter.*onGenerateLink"
---

<objective>
Add keyboard accessibility to all interactive components in the brand-deals page.

Purpose: Users must be able to navigate all tab content with keyboard only -- Tab moves through interactive elements, Enter activates buttons/CTAs, and all focus states are visible.

Output: Five edited components with tabIndex, onKeyDown handlers, focus-visible rings, and proper ARIA attributes.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/phases/57-responsive-accessibility/57-RESEARCH.md

Key source files (read before editing):
@src/components/app/brand-deals/deal-card.tsx
@src/components/app/brand-deals/available-product-card.tsx
@src/components/app/brand-deals/affiliate-link-card.tsx
@src/components/primitives/GlassPill.tsx
@src/components/app/brand-deals/earnings-period-selector.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add keyboard accessibility to card components</name>
  <files>
    src/components/app/brand-deals/deal-card.tsx
    src/components/app/brand-deals/available-product-card.tsx
    src/components/app/brand-deals/affiliate-link-card.tsx
  </files>
  <action>
**DealCard (`deal-card.tsx`):**
On the outer `<div>` element (the card wrapper):
1. Add `tabIndex={0}`
2. Add `role="article"`
3. Add `aria-label={`${deal.brandName} deal: ${payout}`}` (payout is already computed)
4. Add `onKeyDown` handler: if `e.key === "Enter"` and `!isApplied` and `!isExpired`, call `onApply(deal)`. This mirrors the Apply button behavior.
5. Add focus-visible ring classes to the `cn()` call:
   `"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 focus-visible:ring-offset-background"`

**AvailableProductCard (`available-product-card.tsx`):**
On the outer `<div>` element:
1. Add `tabIndex={0}`
2. Add `role="article"`
3. Add `aria-label={`${product.brandName} - ${product.name}: ${product.commissionRate}% commission`}`
4. Add `onKeyDown` handler: if `e.key === "Enter"`, call `onGenerateLink(product)`. This mirrors the Generate Link button behavior.
5. Add focus-visible ring classes to the `cn()` call:
   `"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 focus-visible:ring-offset-background"`

**AffiliateLinkCard (`affiliate-link-card.tsx`):**
On the outer `<div>` element:
1. Add `tabIndex={0}`
2. Add `role="article"`
3. Add `aria-label={`${link.productName} affiliate link`}`
4. NO onKeyDown needed -- the card's primary interactive element is the copy button, which is already a focusable `<button>`. Users Tab into the card, then Tab again to reach the copy button.
5. Add focus-visible ring classes to the `cn()` call:
   `"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 focus-visible:ring-offset-background"`

**Important:** Do NOT remove any existing className strings. Add the focus-visible classes as a new line in the `cn()` call. Preserve all existing hover/transition classes.
  </action>
  <verify>
1. `npx tsc --noEmit` -- zero TypeScript errors
2. Open /brand-deals?tab=deals in browser, press Tab repeatedly -- DealCards receive visible focus ring, pressing Enter on a focused card opens the Apply modal
3. Open /brand-deals?tab=affiliates -- AffiliateLinkCards and AvailableProductCards receive visible focus ring, pressing Enter on a product card triggers Generate Link
  </verify>
  <done>
All three card types have tabIndex={0}, role="article", aria-label, focus-visible ring styling. DealCard and AvailableProductCard have onKeyDown Enter handlers that trigger their primary CTA. AffiliateLinkCard has focus ring but relies on the nested copy button for keyboard activation.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add focus-visible to GlassPill and ARIA semantics to EarningsPeriodSelector</name>
  <files>
    src/components/primitives/GlassPill.tsx
    src/components/app/brand-deals/earnings-period-selector.tsx
  </files>
  <action>
**GlassPill (`src/components/primitives/GlassPill.tsx`):**
In the `cn()` call on the `<Component>` element (line ~112), add focus-visible ring for interactive pills:
1. Add after the `isInteractive &&` line:
   `isInteractive && "focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent"`,
2. This ensures that when GlassPill renders as a `<button>` (has onClick), it shows a visible focus ring when tabbed to.
3. Do NOT add focus ring to non-interactive (span) pills -- the `isInteractive &&` guard handles this.

**EarningsPeriodSelector (`earnings-period-selector.tsx`):**
1. On the outer `<div>` wrapper, add `role="radiogroup"` and `aria-label="Earnings period"`
2. On each `<button>` element inside the `.map()`, add:
   - `role="radio"`
   - `aria-checked={isActive}` (isActive is already computed per period)
3. Keep all existing classes and attributes. Only add the ARIA attributes.
  </action>
  <verify>
1. `npx tsc --noEmit` -- zero TypeScript errors
2. Open /brand-deals?tab=deals -- Tab through the category filter pills (GlassPill), each should show a visible focus ring
3. Open /brand-deals?tab=earnings -- inspect the period selector in DevTools, verify `role="radiogroup"` on container and `role="radio"` + `aria-checked="true"/"false"` on each button
4. Use a screen reader (or browser Accessibility Inspector) to verify the period selector announces as a radio group
  </verify>
  <done>
GlassPill shows focus-visible ring when used as an interactive button. EarningsPeriodSelector has proper WAI-ARIA radiogroup semantics with aria-checked on each period button.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` -- zero TypeScript errors
2. `npm run build` (or `pnpm build`) -- build succeeds
3. Full keyboard navigation test:
   - Start at /brand-deals, press Tab repeatedly
   - Tab reaches the Radix Tabs triggers (arrow keys switch tabs -- Radix handles this)
   - On Deals tab: Tab through filter pills (focus ring visible on each GlassPill), Tab through DealCards (focus ring visible), Enter on a card opens Apply modal
   - On Affiliates tab: Tab through AffiliateLinkCards (focus ring visible), Tab to copy button (already works), Tab through AvailableProductCards (focus ring visible), Enter on a product card triggers Generate Link
   - On Earnings tab: Tab to period selector (radio buttons have aria-checked, focus ring visible), Tab through chart (Recharts handles this)
4. No interactive element is skipped during Tab traversal
5. All focus rings use the accent color and are clearly visible on the dark background
</verification>

<success_criteria>
- All card components (DealCard, AvailableProductCard, AffiliateLinkCard) have tabIndex={0}, role="article", aria-label, and focus-visible ring
- DealCard and AvailableProductCard have onKeyDown Enter handlers activating primary CTA
- GlassPill interactive buttons show focus-visible ring
- EarningsPeriodSelector has role="radiogroup" with aria-checked on each button
- Full keyboard navigation works across all three tabs without skipping interactive elements
- `npx tsc --noEmit` and build both pass
</success_criteria>

<output>
After completion, create `.planning/phases/57-responsive-accessibility/57-02-SUMMARY.md`
</output>
