---
phase: 15-foundation-primitives
plan: 03
type: execute
wave: 2
depends_on: ["15-01"]
files_modified:
  - src/components/primitives/TrafficLights.tsx
  - src/components/primitives/index.ts
  - src/app/(marketing)/primitives-showcase/page.tsx
autonomous: false
requirements_covered:
  - FOUND-04

must_haves:
  truths:
    - "TrafficLights displays red/yellow/green macOS window buttons"
    - "Traffic light buttons are correctly sized (12px circles)"
    - "All primitives render correctly when composed together"
  artifacts:
    - path: "src/components/primitives/TrafficLights.tsx"
      provides: "macOS window button component"
      exports: ["TrafficLights"]
      min_lines: 30
    - path: "src/app/(marketing)/primitives-showcase/page.tsx"
      provides: "Visual showcase of all primitives"
      min_lines: 50
  key_links:
    - from: "src/app/(marketing)/primitives-showcase/page.tsx"
      to: "src/components/primitives"
      via: "Imports GlassPanel, GradientGlow, TrafficLights"
      pattern: "import.*from.*primitives"
---

<objective>
Complete the primitives foundation with TrafficLights component and create a visual showcase page for verification.

Purpose: TrafficLights is the final primitive needed for the macOS window mockups. The showcase page allows visual verification of all primitives working together before Phase 16 (Hero Section) begins.

Output: TrafficLights component, updated barrel export, and primitives showcase page for visual verification.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/components/primitives/index.ts
@src/lib/utils.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TrafficLights component</name>
  <files>src/components/primitives/TrafficLights.tsx</files>
  <action>
Create the TrafficLights component for macOS window mockups:

```typescript
"use client";

import { cn } from "@/lib/utils";

export interface TrafficLightsProps {
  /** Size variant: sm (10px), md (12px), lg (14px) */
  size?: "sm" | "md" | "lg";
  /** Interactive mode - shows hover icons */
  interactive?: boolean;
  /** Disabled/inactive appearance */
  disabled?: boolean;
  /** Additional className for the container */
  className?: string;
  /** Callback when close button clicked (only in interactive mode) */
  onClose?: () => void;
  /** Callback when minimize button clicked (only in interactive mode) */
  onMinimize?: () => void;
  /** Callback when maximize button clicked (only in interactive mode) */
  onMaximize?: () => void;
}

// Exact macOS traffic light colors
const colors = {
  close: {
    fill: "#ed6a5f",
    border: "#e24b41",
  },
  minimize: {
    fill: "#f6be50",
    border: "#e1a73e",
  },
  maximize: {
    fill: "#61c555",
    border: "#2dac2f",
  },
  disabled: {
    fill: "#3d3d3d",
    border: "#2a2a2a",
  },
};

// Size mapping
const sizeMap = {
  sm: 10,
  md: 12,
  lg: 14,
};

/**
 * TrafficLights - macOS window control buttons.
 *
 * Renders the iconic red/yellow/green circles used in macOS window chrome.
 * Optional interactive mode shows x/-/+ icons on hover.
 *
 * @example
 * // Static (decorative)
 * <TrafficLights size="md" />
 *
 * // Interactive
 * <TrafficLights interactive onClose={() => closeWindow()} />
 */
export function TrafficLights({
  size = "md",
  interactive = false,
  disabled = false,
  className,
  onClose,
  onMinimize,
  onMaximize,
}: TrafficLightsProps) {
  const buttonSize = sizeMap[size];
  const gap = Math.round(buttonSize * 0.67); // ~8px gap for 12px buttons

  const buttonStyle = (color: keyof typeof colors) => ({
    width: buttonSize,
    height: buttonSize,
    backgroundColor: disabled ? colors.disabled.fill : colors[color].fill,
    borderColor: disabled ? colors.disabled.border : colors[color].border,
  });

  const Button = ({
    color,
    onClick,
    label,
  }: {
    color: "close" | "minimize" | "maximize";
    onClick?: () => void;
    label: string;
  }) => (
    <button
      type="button"
      onClick={interactive ? onClick : undefined}
      disabled={disabled || !interactive}
      aria-label={label}
      className={cn(
        "rounded-full border transition-transform",
        interactive && !disabled && "hover:scale-110 cursor-pointer",
        !interactive && "cursor-default",
        disabled && "opacity-50"
      )}
      style={buttonStyle(color)}
    />
  );

  return (
    <div
      className={cn("flex items-center", className)}
      style={{ gap }}
      role="group"
      aria-label="Window controls"
    >
      <Button color="close" onClick={onClose} label="Close window" />
      <Button color="minimize" onClick={onMinimize} label="Minimize window" />
      <Button color="maximize" onClick={onMaximize} label="Maximize window" />
    </div>
  );
}
```

Key implementation details:
- Exact macOS colors from research (#ed6a5f, #f6be50, #61c555)
- Border colors for definition (#e24b41, #e1a73e, #2dac2f)
- Three size variants (10px, 12px, 14px)
- Optional interactive mode with callbacks
- Disabled state for inactive windows
- Proper accessibility labels
  </action>
  <verify>
File exists at src/components/primitives/TrafficLights.tsx.
TypeScript compiles: `pnpm tsc --noEmit`
  </verify>
  <done>
TrafficLights component created with exact macOS colors, three size variants, optional interactive mode, and proper accessibility. Matches reference design.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update barrel export and create showcase page</name>
  <files>src/components/primitives/index.ts, src/app/(marketing)/primitives-showcase/page.tsx</files>
  <action>
**Step 1: Update barrel export**

Update src/components/primitives/index.ts to include TrafficLights:

```typescript
export { GlassPanel } from "./GlassPanel";
export type { GlassPanelProps } from "./GlassPanel";

export { GradientGlow } from "./GradientGlow";
export type { GradientGlowProps, GradientColor } from "./GradientGlow";

export { TrafficLights } from "./TrafficLights";
export type { TrafficLightsProps } from "./TrafficLights";
```

**Step 2: Create showcase page**

Create src/app/(marketing)/primitives-showcase/page.tsx:

```typescript
import { GlassPanel, GradientGlow, TrafficLights } from "@/components/primitives";

export const metadata = {
  title: "Primitives Showcase | Virtuna",
  description: "Visual showcase of glassmorphism design primitives",
};

export default function PrimitivesShowcasePage() {
  return (
    <div className="min-h-screen bg-bg-base p-8 md:p-16">
      <h1 className="text-4xl font-bold text-text-primary mb-12">
        Primitives Showcase
      </h1>

      {/* Section 1: TrafficLights */}
      <section className="mb-16">
        <h2 className="text-2xl font-semibold text-text-primary mb-6">
          TrafficLights
        </h2>
        <div className="flex items-center gap-12">
          <div className="flex flex-col items-center gap-2">
            <TrafficLights size="sm" />
            <span className="text-text-secondary text-sm">Small (10px)</span>
          </div>
          <div className="flex flex-col items-center gap-2">
            <TrafficLights size="md" />
            <span className="text-text-secondary text-sm">Medium (12px)</span>
          </div>
          <div className="flex flex-col items-center gap-2">
            <TrafficLights size="lg" />
            <span className="text-text-secondary text-sm">Large (14px)</span>
          </div>
          <div className="flex flex-col items-center gap-2">
            <TrafficLights disabled />
            <span className="text-text-secondary text-sm">Disabled</span>
          </div>
        </div>
      </section>

      {/* Section 2: GradientGlow Colors */}
      <section className="mb-16">
        <h2 className="text-2xl font-semibold text-text-primary mb-6">
          GradientGlow Colors
        </h2>
        <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-8">
          {(["purple", "blue", "pink", "cyan", "green", "orange"] as const).map((color) => (
            <div key={color} className="relative h-32 rounded-xl overflow-hidden bg-surface">
              <GradientGlow color={color} intensity="strong" size={120} position="center" blur={40} />
              <div className="absolute inset-0 flex items-center justify-center">
                <span className="text-text-primary font-medium capitalize">{color}</span>
              </div>
            </div>
          ))}
        </div>
      </section>

      {/* Section 3: GradientGlow Intensities */}
      <section className="mb-16">
        <h2 className="text-2xl font-semibold text-text-primary mb-6">
          GradientGlow Intensities
        </h2>
        <div className="flex gap-8">
          {(["subtle", "medium", "strong"] as const).map((intensity) => (
            <div key={intensity} className="relative h-32 w-48 rounded-xl overflow-hidden bg-surface">
              <GradientGlow color="purple" intensity={intensity} size={150} position="center" blur={50} />
              <div className="absolute inset-0 flex items-center justify-center">
                <span className="text-text-primary font-medium capitalize">{intensity}</span>
              </div>
            </div>
          ))}
        </div>
      </section>

      {/* Section 4: GlassPanel Variants */}
      <section className="mb-16">
        <h2 className="text-2xl font-semibold text-text-primary mb-6">
          GlassPanel Variants
        </h2>
        <div className="relative">
          {/* Background glow for glass effect visibility */}
          <GradientGlow color="blue" intensity="medium" size={600} position="center" blur={120} />

          <div className="relative grid grid-cols-1 md:grid-cols-3 gap-8">
            <GlassPanel blur="sm" className="p-6">
              <h3 className="text-text-primary font-semibold mb-2">Blur: Small</h3>
              <p className="text-text-secondary text-sm">8px blur, 60% opacity</p>
            </GlassPanel>

            <GlassPanel blur="md" className="p-6">
              <h3 className="text-text-primary font-semibold mb-2">Blur: Medium</h3>
              <p className="text-text-secondary text-sm">12px blur, 60% opacity</p>
            </GlassPanel>

            <GlassPanel blur="lg" borderGlow className="p-6">
              <h3 className="text-text-primary font-semibold mb-2">Blur: Large + Glow</h3>
              <p className="text-text-secondary text-sm">20px blur with border glow</p>
            </GlassPanel>
          </div>
        </div>
      </section>

      {/* Section 5: Composed Example - macOS Window */}
      <section className="mb-16">
        <h2 className="text-2xl font-semibold text-text-primary mb-6">
          Composed: macOS Window Mockup
        </h2>
        <div className="relative max-w-2xl">
          <GradientGlow color="purple" intensity="medium" size={400} position="top-left" blur={100} />
          <GradientGlow color="cyan" intensity="subtle" size={300} position="bottom-right" blur={80} />

          <GlassPanel blur="md" className="relative overflow-hidden">
            {/* Window Chrome */}
            <div className="flex items-center gap-4 p-4 border-b border-white/10">
              <TrafficLights size="md" />
              <span className="text-text-secondary text-sm flex-1 text-center">
                Virtuna Dashboard
              </span>
              <div className="w-12" /> {/* Spacer for symmetry */}
            </div>

            {/* Window Content */}
            <div className="p-8">
              <h3 className="text-text-primary text-xl font-semibold mb-4">
                Premium Glass Effect
              </h3>
              <p className="text-text-secondary">
                This demonstrates all three primitives composed together:
                GlassPanel for the frosted container, GradientGlow for ambient
                lighting, and TrafficLights for macOS window chrome.
              </p>
            </div>
          </GlassPanel>
        </div>
      </section>

      {/* Section 6: Elevation Shadows */}
      <section className="mb-16">
        <h2 className="text-2xl font-semibold text-text-primary mb-6">
          Elevation Shadows
        </h2>
        <div className="flex flex-wrap gap-8">
          {(["shadow-sm", "shadow-md", "shadow-lg", "shadow-elevated", "shadow-float"] as const).map((shadow) => (
            <div
              key={shadow}
              className={`bg-surface rounded-xl p-6 ${shadow}`}
            >
              <span className="text-text-primary text-sm">{shadow}</span>
            </div>
          ))}
        </div>
      </section>
    </div>
  );
}
```

This showcase page:
- Displays all TrafficLights size variants
- Shows all GradientGlow colors and intensities
- Demonstrates GlassPanel blur/opacity variants
- Composes a full macOS window mockup example
- Displays all elevation shadows
  </action>
  <verify>
`pnpm build` succeeds.
Navigate to /primitives-showcase in browser to visually verify.
  </verify>
  <done>
Barrel export updated with TrafficLights. Showcase page created at /primitives-showcase displaying all primitives with variants. Build succeeds.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
All Phase 15 primitives: GlassPanel, GradientGlow, TrafficLights, design tokens, elevation shadows.
Showcase page demonstrating all components working together.
  </what-built>
  <how-to-verify>
1. Start dev server: `pnpm dev`
2. Navigate to: http://localhost:3000/primitives-showcase
3. Verify each section:
   - **TrafficLights**: Red/yellow/green circles at 3 sizes, disabled state is gray
   - **GradientGlow Colors**: 6 distinct colors (purple, blue, pink, cyan, green, orange)
   - **GradientGlow Intensities**: Subtle (15%), medium (30%), strong (50%) visible difference
   - **GlassPanel Variants**: Frosted glass effect visible over gradient background
   - **macOS Window Mockup**: Complete composition with traffic lights, title bar, glass panel, glows
   - **Elevation Shadows**: Progressive shadow depth from sm to float
4. Test in Safari (if available): Verify glassmorphism blur renders correctly
5. Resize to mobile: Verify blur is reduced on small screens
  </how-to-verify>
  <resume-signal>Type "approved" if all primitives render correctly, or describe any issues.</resume-signal>
</task>

</tasks>

<verification>
1. TrafficLights.tsx exists with correct macOS colors
2. Barrel export includes all three primitives
3. Showcase page exists at /primitives-showcase
4. All sections render without errors
5. Glass blur effect works in both Chrome and Safari
6. Mobile blur reduction is applied
</verification>

<success_criteria>
- TrafficLights shows red (#ed6a5f), yellow (#f6be50), green (#61c555) circles
- TrafficLights sizes: 10px, 12px, 14px work correctly
- GradientGlow displays all 6 palette colors
- GlassPanel shows visible frosted glass effect
- macOS window mockup composes all primitives successfully
- Showcase page renders without errors
- User approves visual verification
</success_criteria>

<output>
After completion, create `.planning/phases/15-foundation-primitives/15-03-SUMMARY.md`
</output>
