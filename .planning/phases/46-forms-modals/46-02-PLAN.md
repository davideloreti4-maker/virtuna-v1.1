---
phase: 46-forms-modals
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/app/test-type-selector.tsx
autonomous: true

must_haves:
  truths:
    - "TestTypeSelector opens as a design system Dialog (not raw Radix Dialog)"
    - "Test types render as a responsive GlassCard grid (not a 3-column menu)"
    - "Each card shows icon + title + description + optional badge"
    - "Clicking a card immediately proceeds to the form (no intermediate step)"
    - "Cards have hover=lift effect from GlassCard"
    - "Grid is responsive: 1-col mobile, 2-col tablet, 3-col desktop"
    - "Dialog has consistent overlay, animation, and close behavior"
  artifacts:
    - path: "src/components/app/test-type-selector.tsx"
      provides: "TestTypeSelector using Dialog + GlassCard grid"
      contains: "DialogContent"
  key_links:
    - from: "src/components/app/test-type-selector.tsx"
      to: "@/components/ui/dialog"
      via: "import replacing raw Radix Dialog"
      pattern: "import.*Dialog.*from.*ui/dialog"
    - from: "src/components/app/test-type-selector.tsx"
      to: "@/components/primitives/GlassCard"
      via: "import for type cards"
      pattern: "GlassCard.*hover.*lift"
    - from: "src/components/app/test-type-selector.tsx"
      to: "src/components/app/test-creation-flow.tsx"
      via: "onSelectType callback"
      pattern: "onSelectType"
---

<objective>
Rebuild TestTypeSelector as a design system Dialog with a responsive GlassCard grid for type selection.

Purpose: Transform the test type selector from a raw Radix Dialog with a 3-column category menu into a design system Dialog containing a responsive grid of GlassCard components. This is the one component that changes layout structure (FORM-03). Each card shows icon + title + description + optional badge, and clicking immediately proceeds to the selected test type's form.
Output: TestTypeSelector using Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, and GlassCard grid.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/46-forms-modals/46-CONTEXT.md
@.planning/phases/46-forms-modals/46-RESEARCH.md

@src/components/app/test-type-selector.tsx
@src/components/app/test-creation-flow.tsx
@src/components/ui/dialog.tsx
@src/components/primitives/GlassCard.tsx
@src/components/ui/badge.tsx
@src/lib/test-types.ts
@src/types/test.ts
@.planning/BRAND-BIBLE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rebuild TestTypeSelector with Dialog + GlassCard grid</name>
  <files>src/components/app/test-type-selector.tsx</files>
  <action>
**Step 1: Read current component**
Read `src/components/app/test-type-selector.tsx` to understand:
- `TestTypeSelectorProps` interface (`open`, `onOpenChange`, `onSelectType`)
- The raw Radix Dialog import (`import * as Dialog from "@radix-ui/react-dialog"`)
- The 3-column category menu layout with `MenuItem` sub-component
- The `TEST_CATEGORIES` and `TEST_TYPES` data structures from `@/lib/test-types.ts`
- Custom SVG components: `XLogo`, `TikTokLogo`
- The `handleRequestNewContext` stub
- Icon mapping for each test type (Lucide icons)

Also read `src/lib/test-types.ts` to understand available test type data (names, descriptions, icon names).

**Step 2: Read design system components**
Read these files to understand their APIs:
- `src/components/ui/dialog.tsx` — exports: `Dialog`, `DialogContent` (size: "sm"|"md"|"lg"|"xl"|"full"), `DialogHeader`, `DialogTitle`, `DialogDescription`, `DialogClose`, `DialogTrigger`, `DialogFooter`
- `src/components/primitives/GlassCard.tsx` — props: `color` (GradientColor), `tinted`, `glow`, `hover` ("none"|"lift"|"glow-boost"), `padding` ("none"|"sm"|"md"|"lg"), `onClick`, `className`
- `src/components/ui/badge.tsx` — props: `variant`, `size`
- `src/components/ui/button.tsx` — props: `variant`, `size`, `loading`, `asChild`

**Step 3: Generate via v0**
Load the v0 MCP tool via ToolSearch (query: "select:mcp__v0__v0_generate_ui"), then call `mcp__v0__v0_generate_ui` with a prompt that includes:

- The current test-type-selector.tsx code (full, since this is a complete rewrite of the layout)
- The design system component APIs: Dialog/DialogContent (size variants, glass styling, animations built-in), GlassCard (hover="lift", padding="md", onClick), Badge (variant, size), Button (variant, size)
- Brand bible context: dark theme (bg-base #0A0A0B), glass surfaces, coral accent (#E57850), Satoshi body font, Funnel Display headings
- Requirements:
  - Replace raw `import * as Dialog from "@radix-ui/react-dialog"` with design system Dialog imports from `@/components/ui/dialog`
  - Use `<DialogContent size="xl" className="max-w-3xl">` (768px) to fit 3-column card grid
  - Add `<DialogHeader>` with `<DialogTitle>What would you like to simulate?</DialogTitle>` and `<DialogDescription>Select a test type to begin</DialogDescription>`
  - DELETE the entire 3-column category menu layout and `MenuItem` component
  - Flatten all 11 test types into a responsive grid: `grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4`
  - Each test type renders as `<GlassCard hover="lift" padding="md" onClick={() => handleSelectType(typeId)}>` with:
    - Icon: Keep existing Lucide icon from TEST_TYPES or icon mapping, `h-8 w-8 text-foreground-secondary`
    - Title: `<span className="font-semibold text-foreground">{name}</span>`
    - Description: `<span className="text-sm text-foreground-secondary line-clamp-1">{description}</span>`
    - Badge (optional): `<Badge variant="info" size="sm">Popular</Badge>` on survey, `<Badge variant="accent" size="sm">New</Badge>` on tiktok-script
  - All 11 test types: survey, article, website-content, advertisement, linkedin-post, instagram-post, x-post, tiktok-script, email-subject-line, email, product-proposition
  - Selection: click card -> call `onSelectType(typeId)` immediately (no intermediate step)
  - Footer: "Request a new context" button with `<Button variant="ghost" size="sm">` + Plus icon, below grid with `border-t border-border` separator
  - Replace ALL hardcoded colors: `border-[rgb(...)]` -> `border-border`, `bg-[rgba(...)]` -> remove (Dialog handles glass bg), `text-white` -> `text-foreground`, `text-[rgb(184,...)]` -> `text-foreground-secondary`
- What to preserve: `XLogo` and `TikTokLogo` custom SVG components (keep in file), `TestTypeSelectorProps` interface and all 3 props, `handleRequestNewContext` stub

**Step 4: Integrate v0 output**
Write v0's generated code to `src/components/app/test-type-selector.tsx`, then manually adjust:
- Fix import paths: Dialog components from `@/components/ui/dialog`, GlassCard from `@/components/primitives/GlassCard`, Badge from `@/components/ui/badge`, Button from `@/components/ui/button`
- Re-add `XLogo` and `TikTokLogo` SVG components if v0 didn't include them
- Wire `onSelectType` callback correctly — card click should call `onSelectType(typeId)` and Dialog closes via parent `onOpenChange`
- Ensure icon mapping covers all 11 types with correct Lucide imports
- If test type descriptions aren't in TEST_TYPES from `@/lib/test-types.ts`, add brief inline descriptions as a local config object
- Verify `handleRequestNewContext` stub is preserved

**Step 5: Verify**
Run `npx tsc --noEmit`. Grep for `"@radix-ui/react-dialog"` — must return zero. Grep for `DialogContent` and `GlassCard` — must find them. Grep for `grid-cols` — must find responsive grid. Grep for hardcoded colors (`rgb(`, `rgba(`, `bg-\[`, `border-\[`) — must return zero.
  </action>
  <verify>
Run `npx tsc --noEmit` to verify no TypeScript errors. Grep for `"@radix-ui/react-dialog"` in test-type-selector.tsx to confirm raw Radix is removed. Grep for `DialogContent` and `GlassCard` to confirm design system usage. Grep for `grid-cols` to confirm responsive grid. Grep for hardcoded colors (`rgb(`, `rgba(`, `bg-\[`, `border-\[`) to confirm zero hardcoded values.
  </verify>
  <done>
TestTypeSelector renders as a design system Dialog with a responsive GlassCard grid showing all 11 test types. Each card has icon + title + description + optional badge. Grid is 1-col mobile, 2-col tablet, 3-col desktop. Clicking a card immediately calls onSelectType. Raw Radix Dialog import removed. All hardcoded colors replaced. Custom XLogo/TikTokLogo SVGs preserved. No TypeScript errors.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `grep -c "@radix-ui/react-dialog" src/components/app/test-type-selector.tsx` returns 0
3. `grep -c "DialogContent" src/components/app/test-type-selector.tsx` returns >= 1
4. `grep -c "GlassCard" src/components/app/test-type-selector.tsx` returns >= 1
5. `grep -c "grid-cols" src/components/app/test-type-selector.tsx` returns >= 1
6. `grep -c "MenuItem" src/components/app/test-type-selector.tsx` returns 0 (old component deleted)
7. `grep -c "rgb\|rgba\|bg-\\\[" src/components/app/test-type-selector.tsx` returns 0
8. `npm run build` completes without errors
</verification>

<success_criteria>
- TestTypeSelector uses Dialog from @/components/ui/dialog (not raw Radix)
- Test types display as responsive GlassCard grid (not 3-column category menu)
- Cards have icon + title + description + optional badge
- Cards use hover="lift" from GlassCard
- Clicking a card calls onSelectType immediately
- Grid responsive: 1-col mobile, 2-col tablet, 3-col desktop
- Props interface unchanged (test-creation-flow.tsx needs no changes)
- Zero hardcoded color values
</success_criteria>

<output>
After completion, create `.planning/phases/46-forms-modals/46-02-SUMMARY.md`
</output>
