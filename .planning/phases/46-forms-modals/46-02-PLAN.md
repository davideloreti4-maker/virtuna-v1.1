---
phase: 46-forms-modals
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/app/test-type-selector.tsx
autonomous: true

must_haves:
  truths:
    - "TestTypeSelector opens as a design system Dialog (not raw Radix Dialog)"
    - "Test types render as a responsive GlassCard grid (not a 3-column menu)"
    - "Each card shows icon + title + description + optional badge"
    - "Clicking a card immediately proceeds to the form (no intermediate step)"
    - "Cards have hover=lift effect from GlassCard"
    - "Grid is responsive: 1-col mobile, 2-col tablet, 3-col desktop"
    - "Dialog has consistent overlay, animation, and close behavior"
  artifacts:
    - path: "src/components/app/test-type-selector.tsx"
      provides: "TestTypeSelector using Dialog + GlassCard grid"
      contains: "DialogContent"
  key_links:
    - from: "src/components/app/test-type-selector.tsx"
      to: "@/components/ui/dialog"
      via: "import replacing raw Radix Dialog"
      pattern: "import.*Dialog.*from.*ui/dialog"
    - from: "src/components/app/test-type-selector.tsx"
      to: "@/components/primitives/GlassCard"
      via: "import for type cards"
      pattern: "GlassCard.*hover.*lift"
    - from: "src/components/app/test-type-selector.tsx"
      to: "src/components/app/test-creation-flow.tsx"
      via: "onSelectType callback"
      pattern: "onSelectType"
---

<objective>
Rebuild TestTypeSelector as a design system Dialog with a responsive GlassCard grid for type selection.

Purpose: Transform the test type selector from a raw Radix Dialog with a 3-column category menu into a design system Dialog containing a responsive grid of GlassCard components. This is the one component that changes layout structure (FORM-03). Each card shows icon + title + description + optional badge, and clicking immediately proceeds to the selected test type's form.
Output: TestTypeSelector using Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, and GlassCard grid.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/46-forms-modals/46-CONTEXT.md
@.planning/phases/46-forms-modals/46-RESEARCH.md

@src/components/app/test-type-selector.tsx
@src/components/app/test-creation-flow.tsx
@src/components/ui/dialog.tsx
@src/components/primitives/GlassCard.tsx
@src/components/ui/badge.tsx
@src/lib/test-types.ts
@src/types/test.ts
@BRAND-BIBLE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rebuild TestTypeSelector with Dialog + GlassCard grid</name>
  <files>src/components/app/test-type-selector.tsx</files>
  <action>
Completely rewrite `test-type-selector.tsx` to use the design system Dialog and GlassCard grid. Use v0 MCP as the primary UI generation tool -- provide BRAND-BIBLE.md and current component code as context.

**Dialog migration:**
- Remove `import * as Dialog from "@radix-ui/react-dialog"`.
- Import `{ Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription }` from `@/components/ui/dialog`.
- Import `{ Button }` from `@/components/ui/button` for the close button (use `DialogClose` + `Button variant="ghost" size="sm"` with X icon).
- Use `DialogContent size="xl"` (576px max-width) to accommodate the card grid. Consider using `size="full"` if 576px is too narrow for 3-column grid -- the xl variant at 576px can fit 2 columns comfortably, or use `className="max-w-3xl"` to override to 768px.

**Card grid layout:**
- Delete the entire 3-column category menu layout (the `<div className="grid grid-cols-3 gap-6 px-3">` section with category headers and `MenuItem` components).
- Delete the `MenuItem` component entirely.
- Flatten all 11 test types into a single responsive grid.
- Grid: `grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4`.
- Import `GlassCard` from `@/components/primitives` (or `@/components/primitives/GlassCard`).
- Import `Badge` from `@/components/ui/badge`.

**Card content for each test type:**
- Each card is a `<GlassCard hover="lift" padding="md">` wrapped in a clickable container.
- Make the GlassCard clickable: wrap in a button or add `onClick` + `cursor-pointer` + `role="button"`.
- Card content (flex column, gap-2):
  1. Icon: Use the existing icon from `TEST_TYPES` config or the Lucide icon mapping. Keep Lucide icons (icon migration is separate scope). For X and TikTok, keep the custom SVG components (`XLogo`, `TikTokLogo`). Size: `h-8 w-8 text-foreground-secondary`.
  2. Title: `<span className="font-semibold text-foreground">{config.name}</span>`.
  3. Description: `<span className="text-sm text-foreground-secondary line-clamp-1">{config.description || brief text}</span>`. If `TEST_TYPES` doesn't have descriptions, add brief inline descriptions for each type.
  4. Badge (optional): Add `<Badge variant="info" size="sm">Popular</Badge>` to the "survey" type. Add `<Badge variant="accent" size="sm">New</Badge>` to "tiktok-script" type.

**Test types to render (all 11 from current implementation):**
1. `survey` - ClipboardList icon - "Gather opinions from your society" - Badge: Popular
2. `article` - Pencil icon - "Test marketing articles"
3. `website-content` - AppWindow icon - "Test website copy"
4. `advertisement` - Megaphone icon - "Test ad campaigns"
5. `linkedin-post` - Linkedin icon - "Test LinkedIn content"
6. `instagram-post` - Instagram icon - "Test Instagram posts"
7. `x-post` - XLogo custom SVG - "Test X/Twitter posts"
8. `tiktok-script` - TikTokLogo custom SVG - "Test TikTok scripts" - Badge: New
9. `email-subject-line` - Mail icon - "Test email subject lines"
10. `email` - Mail icon - "Test full emails"
11. `product-proposition` - Lightbulb icon - "Test product concepts"

NOTE: If `TEST_TYPES` from `@/lib/test-types.ts` already has description fields, use those. Otherwise, add the descriptions inline in the component as a local config.

**Selection behavior:**
- On card click: call `onSelectType(typeId)` immediately. No intermediate confirmation. The Dialog closes via the parent `onOpenChange`.
- No selected state needed (immediate proceed means no multi-step selection).

**Footer:**
- Keep the "Request a new context" button but style with `<Button variant="ghost" size="sm">` with Plus icon. Place below the grid with a `border-t border-border` separator.

**Token migration:**
- All hardcoded colors replaced: `border-[rgb(40,40,40)]` -> `border-border`, `bg-[rgba(6,6,6,0.667)]` -> removed (Dialog handles glass bg), `text-white` -> `text-foreground`, `text-[rgb(184,184,184)]` -> `text-foreground-secondary`, `text-[rgb(221,221,221)]` -> `text-foreground`.

**Preserve:**
- `XLogo` and `TikTokLogo` custom SVG components (keep them in this file).
- `TestTypeSelectorProps` interface and all three props (`open`, `onOpenChange`, `onSelectType`).
- The `handleRequestNewContext` stub.
  </action>
  <verify>
Run `npx tsc --noEmit` to verify no TypeScript errors. Grep for `"@radix-ui/react-dialog"` in test-type-selector.tsx to confirm raw Radix is removed. Grep for `DialogContent` and `GlassCard` to confirm design system usage. Grep for `grid-cols` to confirm responsive grid. Grep for hardcoded colors (`rgb(`, `rgba(`, `bg-\[`, `border-\[`) to confirm zero hardcoded values.
  </verify>
  <done>
TestTypeSelector renders as a design system Dialog with a responsive GlassCard grid showing all 11 test types. Each card has icon + title + description + optional badge. Grid is 1-col mobile, 2-col tablet, 3-col desktop. Clicking a card immediately calls onSelectType. Raw Radix Dialog import removed. All hardcoded colors replaced. Custom XLogo/TikTokLogo SVGs preserved. No TypeScript errors.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `grep -c "@radix-ui/react-dialog" src/components/app/test-type-selector.tsx` returns 0
3. `grep -c "DialogContent" src/components/app/test-type-selector.tsx` returns >= 1
4. `grep -c "GlassCard" src/components/app/test-type-selector.tsx` returns >= 1
5. `grep -c "grid-cols" src/components/app/test-type-selector.tsx` returns >= 1
6. `grep -c "MenuItem" src/components/app/test-type-selector.tsx` returns 0 (old component deleted)
7. `grep -c "rgb\|rgba\|bg-\\\[" src/components/app/test-type-selector.tsx` returns 0
8. `npm run build` completes without errors
</verification>

<success_criteria>
- TestTypeSelector uses Dialog from @/components/ui/dialog (not raw Radix)
- Test types display as responsive GlassCard grid (not 3-column category menu)
- Cards have icon + title + description + optional badge
- Cards use hover="lift" from GlassCard
- Clicking a card calls onSelectType immediately
- Grid responsive: 1-col mobile, 2-col tablet, 3-col desktop
- Props interface unchanged (test-creation-flow.tsx needs no changes)
- Zero hardcoded color values
</success_criteria>

<output>
After completion, create `.planning/phases/46-forms-modals/46-02-SUMMARY.md`
</output>
