---
phase: 07-simulation-results
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types/test.ts
  - src/lib/mock-data.ts
autonomous: true

must_haves:
  truths:
    - "TestResult includes variants array"
    - "TestResult includes insights array"
    - "TestResult includes conversationThemes array"
    - "Mock data generates realistic variants with different scores"
    - "Mock data generates 3-4 insights"
    - "Mock data generates 2-3 conversation themes with quotes"
  artifacts:
    - path: "src/types/test.ts"
      provides: "Extended TestResult interface"
      contains: "variants"
    - path: "src/lib/mock-data.ts"
      provides: "Mock data generators"
      exports: ["generateMockVariants", "generateMockInsights", "generateMockThemes"]
  key_links:
    - from: "src/lib/mock-data.ts"
      to: "test-store"
      via: "import in submitTest"
      pattern: "import.*mock-data"
---

<objective>
Extend TestResult interface and create mock data generators

Purpose: Support full results display with variants, insights, and conversation themes
Output: Extended types and mock data module for realistic test results
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-simulation-results/07-RESEARCH.md
@.planning/phases/07-simulation-results/07-CONTEXT.md
@src/types/test.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend TestResult interface with variants/insights/themes</name>
  <files>src/types/test.ts</files>
  <action>
    Extend src/types/test.ts:

    1. Add Variant interface:
    ```typescript
    /**
     * A content variant (original or AI-generated alternative)
     */
    export interface Variant {
      id: string;
      type: 'original' | 'ai-generated';
      content: string;
      impactScore: number;
      label?: string; // e.g., "More engaging hook", "Clearer value prop"
    }
    ```

    2. Add ConversationTheme interface:
    ```typescript
    /**
     * A conversation theme from the simulation
     */
    export interface ConversationTheme {
      id: string;
      title: string;
      percentage: number;
      description: string;
      quotes: string[];
    }
    ```

    3. Add ImpactLabel type:
    ```typescript
    /**
     * Rating label for impact score
     */
    export type ImpactLabel = 'Poor' | 'Below Average' | 'Average' | 'Good' | 'Excellent';
    ```

    4. Extend TestResult interface:
    ```typescript
    export interface TestResult {
      id: string;
      testType: TestType;
      content: string;
      impactScore: number;
      impactLabel: ImpactLabel;
      attention: {
        full: number;
        partial: number;
        ignore: number;
      };
      variants: Variant[];
      insights: string[];
      conversationThemes: ConversationTheme[];
      createdAt: string;
      societyId: string;
    }
    ```

    Keep all existing types (TestType, TestTypeIcon, TestTypeConfig, TestCategory, TestStatus).
  </action>
  <verify>npm run build succeeds with no type errors</verify>
  <done>TestResult interface includes variants, insights, conversationThemes, impactLabel</done>
</task>

<task type="auto">
  <name>Task 2: Create mock data generators</name>
  <files>src/lib/mock-data.ts</files>
  <action>
    Create src/lib/mock-data.ts with realistic mock data generators:

    ```typescript
    import type { Variant, ConversationTheme, ImpactLabel } from '@/types/test';

    /**
     * Generate unique ID
     */
    function generateId(prefix: string): string {
      return `${prefix}_${Date.now()}_${Math.random().toString(36).substring(2, 7)}`;
    }

    /**
     * Get impact label from score
     */
    export function getImpactLabel(score: number): ImpactLabel {
      if (score >= 85) return 'Excellent';
      if (score >= 70) return 'Good';
      if (score >= 55) return 'Average';
      if (score >= 40) return 'Below Average';
      return 'Poor';
    }

    /**
     * Generate variant content based on original
     * Creates realistic variations by modifying hooks/structure
     */
    const VARIANT_TEMPLATES = [
      { label: 'More engaging hook', prefix: 'Hey! ' },
      { label: 'Direct approach', prefix: '' },
      { label: 'Question opener', prefix: 'What if ' },
      { label: 'Urgency added', prefix: 'Limited time: ' },
      { label: 'Personal touch', prefix: 'Just for you: ' },
    ];

    export function generateMockVariants(originalContent: string): Variant[] {
      const originalScore = Math.floor(Math.random() * 20) + 60; // 60-80

      const variants: Variant[] = [
        {
          id: generateId('var'),
          type: 'original',
          content: originalContent,
          impactScore: originalScore,
        },
      ];

      // Generate 2 AI variants (usually score higher)
      const usedTemplates = VARIANT_TEMPLATES
        .sort(() => Math.random() - 0.5)
        .slice(0, 2);

      usedTemplates.forEach((template, i) => {
        const variantScore = Math.min(95, originalScore + Math.floor(Math.random() * 15) + 5);
        const shortenedContent = originalContent.length > 100
          ? originalContent.substring(0, 100) + '...'
          : originalContent;

        variants.push({
          id: generateId('var'),
          type: 'ai-generated',
          content: template.prefix + shortenedContent,
          impactScore: variantScore,
          label: template.label,
        });
      });

      return variants;
    }

    /**
     * Insight templates for different content types
     */
    const INSIGHT_TEMPLATES = [
      'The content received {engagement} engagement. {detail}',
      'Users focused on {aspect} found the content {reaction}.',
      'The {element} could be {improvement} for better impact.',
      'Overall sentiment was {sentiment}, with {percentage}% responding positively.',
      'The hook captured attention effectively, but {suggestion}.',
      'Consider {action} to increase engagement with your target audience.',
    ];

    const INSIGHT_FILLS = {
      engagement: ['above average', 'average', 'moderate', 'strong'],
      detail: [
        'Early-stage professionals showed the highest interest.',
        'The message resonated well with decision-makers.',
        'Visual learners particularly appreciated the format.',
      ],
      aspect: ['career growth', 'innovation', 'efficiency', 'value proposition'],
      reaction: ['highly engaging', 'moderately interesting', 'compelling'],
      element: ['call-to-action', 'opening hook', 'value proposition', 'closing statement'],
      improvement: ['strengthened', 'made more specific', 'shortened', 'personalized'],
      sentiment: ['positive', 'mixed but leaning positive', 'neutral to positive'],
      percentage: ['65', '72', '58', '81'],
      suggestion: ['consider adding social proof', 'the middle section loses some readers', 'timing could be optimized'],
      action: ['adding specific metrics', 'including testimonials', 'shortening the message', 'personalizing the opener'],
    };

    export function generateMockInsights(): string[] {
      const numInsights = Math.floor(Math.random() * 2) + 3; // 3-4 insights
      const insights: string[] = [];
      const usedTemplates = [...INSIGHT_TEMPLATES].sort(() => Math.random() - 0.5);

      for (let i = 0; i < numInsights; i++) {
        let insight = usedTemplates[i % usedTemplates.length];

        // Fill in placeholders
        Object.entries(INSIGHT_FILLS).forEach(([key, values]) => {
          const placeholder = `{${key}}`;
          if (insight.includes(placeholder)) {
            const randomValue = values[Math.floor(Math.random() * values.length)];
            insight = insight.replace(placeholder, randomValue);
          }
        });

        insights.push(insight);
      }

      return insights;
    }

    /**
     * Conversation theme templates
     */
    const THEME_TEMPLATES = [
      {
        title: 'Professional Appeal',
        descriptions: [
          'Users associated the content with professionalism and credibility.',
          'The tone resonated with career-focused individuals.',
        ],
        quotes: [
          '"This feels trustworthy and well-researched."',
          '"Exactly what I\'d expect from a leader in the space."',
          '"Professional without being boring."',
        ],
      },
      {
        title: 'Emotional Connection',
        descriptions: [
          'Strong emotional resonance with the target audience.',
          'The content created a sense of belonging and understanding.',
        ],
        quotes: [
          '"This really speaks to me."',
          '"Finally, someone who gets it."',
          '"I felt understood reading this."',
        ],
      },
      {
        title: 'Value Clarity',
        descriptions: [
          'Users quickly understood the value proposition.',
          'The benefits were clear and compelling.',
        ],
        quotes: [
          '"I immediately knew what was in it for me."',
          '"Clear and to the point."',
          '"No fluff, just value."',
        ],
      },
      {
        title: 'Call to Action Response',
        descriptions: [
          'The CTA generated curiosity and intent to act.',
          'Users expressed willingness to take the next step.',
        ],
        quotes: [
          '"I wanted to learn more right away."',
          '"The next step was obvious."',
          '"Easy to understand what to do next."',
        ],
      },
      {
        title: 'Skepticism Points',
        descriptions: [
          'Some users expressed uncertainty about specific claims.',
          'Additional proof points could address doubts.',
        ],
        quotes: [
          '"Sounds good, but I\'d want to see data."',
          '"A bit too good to be true?"',
          '"Would love to see case studies."',
        ],
      },
    ];

    export function generateMockThemes(): ConversationTheme[] {
      const numThemes = Math.floor(Math.random() * 2) + 2; // 2-3 themes
      const usedTemplates = [...THEME_TEMPLATES]
        .sort(() => Math.random() - 0.5)
        .slice(0, numThemes);

      // Generate percentages that roughly make sense (don't need to sum to 100)
      let remainingPercentage = 100;

      return usedTemplates.map((template, index) => {
        const isLast = index === usedTemplates.length - 1;
        const percentage = isLast
          ? remainingPercentage
          : Math.floor(Math.random() * 30) + 20; // 20-50%

        remainingPercentage -= percentage;

        return {
          id: generateId('theme'),
          title: template.title,
          percentage: Math.max(10, percentage), // minimum 10%
          description: template.descriptions[Math.floor(Math.random() * template.descriptions.length)],
          quotes: template.quotes
            .sort(() => Math.random() - 0.5)
            .slice(0, Math.floor(Math.random() * 2) + 2), // 2-3 quotes
        };
      });
    }
    ```
  </action>
  <verify>npm run build succeeds, no TypeScript errors</verify>
  <done>Mock data generators created for variants, insights, and themes</done>
</task>

</tasks>

<verification>
- Build succeeds: `npm run build`
- Types export correctly from @/types/test
- Mock data functions exported from @/lib/mock-data
</verification>

<success_criteria>
- TestResult interface extended with variants, insights, conversationThemes
- ImpactLabel type defined
- generateMockVariants returns original + 2 AI variants
- generateMockInsights returns 3-4 realistic insights
- generateMockThemes returns 2-3 themes with quotes
</success_criteria>

<output>
After completion, create `.planning/phases/07-simulation-results/07-03-SUMMARY.md`
</output>
