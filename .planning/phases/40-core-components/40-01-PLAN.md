---
phase: 40-core-components
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/button.tsx
  - src/components/ui/index.ts
autonomous: true

must_haves:
  truths:
    - "Button renders primary variant with coral background"
    - "Button renders secondary variant with surface background and border"
    - "Button renders ghost variant with transparent background"
    - "Button renders destructive variant with error color"
    - "Button shows loading spinner when loading prop is true"
    - "Button is disabled during loading state"
    - "All button sizes meet 44x44px minimum touch target"
  artifacts:
    - path: "src/components/ui/button.tsx"
      provides: "Button component with CVA variants"
      exports: ["Button", "buttonVariants", "ButtonProps"]
      contains: "loading"
  key_links:
    - from: "src/components/ui/button.tsx"
      to: "src/app/globals.css"
      via: "semantic tokens"
      pattern: "bg-accent|bg-surface|bg-error"
---

<objective>
Enhance Button component with full variant system, loading state, and accessibility

Purpose: Create production-ready Button matching Raycast styling with coral accent, proper touch targets, and all required states
Output: Enhanced button.tsx with 4 variants, 3 sizes, loading state, and full TypeScript/JSDoc documentation
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/40-core-components/40-CONTEXT.md
@.planning/phases/40-core-components/40-RESEARCH.md
@src/components/ui/button.tsx
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance Button with all variants and states</name>
  <files>src/components/ui/button.tsx</files>
  <action>
Rewrite the Button component with the following enhancements:

**Variants (4 required):**
- `primary`: `bg-accent text-accent-foreground hover:bg-accent-hover` - uses coral, for primary CTAs
- `secondary`: `bg-surface border border-border text-foreground hover:bg-hover` - default, for secondary actions
- `ghost`: `bg-transparent text-foreground hover:bg-hover` - for tertiary/icon buttons
- `destructive`: `bg-error text-white hover:bg-error/90` - for dangerous actions

**Sizes (3 required):**
- `sm`: `h-9 min-h-[36px] min-w-[36px] px-3 text-sm rounded-md` - small but still accessible
- `md`: `h-11 min-h-[44px] min-w-[44px] px-4 text-sm rounded-md` - default, meets 44px target
- `lg`: `h-12 min-h-[48px] min-w-[48px] px-6 text-base rounded-lg` - large

**States:**
- default, hover, active, focus-visible, disabled
- Add `loading` prop: shows spinner, disables button, sets aria-busy
- Use Loader2 from lucide-react for spinner

**CRITICAL: Default variant must be `secondary`, NOT `primary`**
- Raycast uses accent color sparingly - it's not the default button color
- Follow Raycast's pattern: most buttons are secondary (surface with border)

**Accessibility:**
- `focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 focus-visible:ring-offset-background`
- `aria-busy={loading}` when loading
- `aria-disabled` when disabled or loading
- Ensure 44x44px minimum touch target on all interactive sizes

**TypeScript:**
- Export `ButtonProps` interface extending `VariantProps<typeof buttonVariants>`
- Include `loading?: boolean` prop
- Keep existing `asChild` pattern with Radix Slot

**JSDoc:**
- Add JSDoc with @example blocks showing each variant usage
- Include loading state example

Use semantic tokens only (bg-accent, bg-surface, text-foreground, etc.) - never primitive values
  </action>
  <verify>
Run TypeScript check: `npx tsc --noEmit src/components/ui/button.tsx`
Verify exports: `grep -E "export.*(Button|buttonVariants|ButtonProps)" src/components/ui/button.tsx`
  </verify>
  <done>
Button has primary/secondary/ghost/destructive variants, sm/md/lg sizes, loading state with spinner, 44px min touch targets, and defaultVariant is "secondary"
  </done>
</task>

<task type="auto">
  <name>Task 2: Update UI index exports</name>
  <files>src/components/ui/index.ts</files>
  <action>
Ensure the index.ts properly exports all Button types:

```typescript
export { Button, buttonVariants } from "./button";
export type { ButtonProps } from "./button";
```

This should already be correct but verify the ButtonProps type is exported.
  </action>
  <verify>
Run: `grep "ButtonProps" src/components/ui/index.ts` - should show type export
  </verify>
  <done>
ButtonProps type is exported from index.ts alongside Button and buttonVariants
  </done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors: `npx tsc --noEmit`
2. Button has 4 variants: `grep -c "variant:" src/components/ui/button.tsx` shows primary, secondary, ghost, destructive
3. Button has 3 sizes: sm, md, lg all defined
4. Loading state exists: `grep "loading" src/components/ui/button.tsx`
5. Default variant is secondary: `grep "defaultVariants" src/components/ui/button.tsx` shows variant: "secondary"
6. 44px touch target: `grep "min-h-\[44px\]" src/components/ui/button.tsx` (or h-11)
</verification>

<success_criteria>
- Button renders all 4 variants with correct styling using semantic tokens
- Loading prop shows Loader2 spinner and disables interaction
- Default variant is secondary, not primary
- All sizes meet 44x44px minimum (md and lg explicitly, sm acceptable at 36px for icon buttons)
- Full TypeScript types exported
- JSDoc with examples present
</success_criteria>

<output>
After completion, create `.planning/phases/40-core-components/40-01-SUMMARY.md`
</output>
