---
phase: 01-sidebar-navigation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/app/sidebar.tsx
  - src/components/app/sidebar-nav-item.tsx
  - src/components/app/sidebar-toggle.tsx
  - src/components/app/app-shell.tsx
autonomous: true

must_haves:
  truths:
    - "Sidebar is solid dark (#07080a), not glassmorphic, docked flush to left edge with no rounded corners"
    - "Active nav item shows a coral left-border indicator with subtle bg highlight, not a filled bg block"
    - "Only four nav items exist: Dashboard, Trending, Referrals (top group) and Pricing (bottom group)"
    - "Content Intelligence nav item is completely removed from the sidebar"
    - "TikTok account section is positioned above nav items in its own section"
    - "Sidebar slides fully off-screen when collapsed with no icon rail"
    - "Main content area adjusts margin correctly for flush sidebar (no inset gap)"
  artifacts:
    - path: "src/components/app/sidebar.tsx"
      provides: "Restructured sidebar with solid bg, flush layout, new nav order, TikTok section above nav"
      contains: "bg-\\[#07080a\\]|bg-background"
    - path: "src/components/app/sidebar-nav-item.tsx"
      provides: "Nav item with coral left-border active indicator"
      contains: "border-l|border-accent"
    - path: "src/components/app/app-shell.tsx"
      provides: "Updated margin for flush sidebar (260px, no inset offset)"
      contains: "md:ml-\\[260px\\]"
  key_links:
    - from: "src/components/app/sidebar.tsx"
      to: "src/components/app/sidebar-nav-item.tsx"
      via: "SidebarNavItem component usage"
      pattern: "<SidebarNavItem"
    - from: "src/components/app/app-shell.tsx"
      to: "src/components/app/sidebar.tsx"
      via: "Sidebar rendered inside AppShell"
      pattern: "<Sidebar"
---

<objective>
Overhaul the sidebar's visual design and navigation structure to match Raycast's design language. Replace the glassmorphic floating panel with a solid dark sidebar docked flush to the left edge. Restructure navigation items per user decisions: remove the duplicate "Content Intelligence" item, flatten to Dashboard/Trending/Referrals (top) and Pricing (bottom). Restyle the active nav item to use a coral left-border indicator instead of a filled background block. Reposition the TikTok account section above nav items.

Purpose: Foundation for all app pages -- sidebar appears on every authenticated route, so getting it right first unblocks all subsequent phases.
Output: Visually correct sidebar with proper navigation structure, matching Raycast aesthetic.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-sidebar-navigation/01-CONTEXT.md
@BRAND-BIBLE.md
@src/components/app/sidebar.tsx
@src/components/app/sidebar-nav-item.tsx
@src/components/app/sidebar-toggle.tsx
@src/components/app/app-shell.tsx
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Restyle sidebar container — solid dark, flush, no rounded corners</name>
  <files>
    src/components/app/sidebar.tsx
    src/components/app/app-shell.tsx
  </files>
  <action>
    **sidebar.tsx changes:**
    1. Remove the glassmorphic inline styles: delete the `style` prop with `backgroundImage`, `backdropFilter`, `WebkitBackdropFilter`, and `boxShadow` (the glass gradient + blur + inset shadow).
    2. Replace with solid dark background: add `bg-background` class (maps to --color-background which is #07080a / gray-950).
    3. Remove floating/inset positioning: change `fixed top-3 left-3 bottom-3` to `fixed top-0 left-0 bottom-0` — dock flush to left edge, full viewport height.
    4. Remove `rounded-xl` class — no rounded corners when flush.
    5. Keep `border border-white/[0.06]` but only apply it to the RIGHT edge since left/top/bottom are flush: change to `border-r border-white/[0.06]` (right border only).
    6. Keep `w-[260px]` width.
    7. Update collapse animation: change `-translate-x-[calc(100%+12px)]` to `-translate-x-full` (no extra 12px offset since no inset).
    8. Keep mobile overlay behavior as-is.

    **app-shell.tsx changes:**
    1. Update main content margin: change `md:ml-[284px]` to `md:ml-[260px]` — sidebar is 260px flush (no 12px inset + 12px gap = 24px extra that previously existed).

    **sidebar-toggle.tsx changes (if needed):**
    1. Adjust toggle position if the `left-4 top-4` placement conflicts with the new flush sidebar. The toggle should appear when sidebar is collapsed. Current positioning is fine since it only shows when sidebar is hidden.
  </action>
  <verify>
    Run `npx next build` or `npx tsc --noEmit` to confirm no type errors. Visually: sidebar should be solid dark (#07080a), flush to left edge with no gap, right-side border only, full viewport height, no rounded corners. When collapsed, slides completely off-screen. Main content fills the space correctly.
  </verify>
  <done>
    Sidebar is solid dark (#07080a), flush to left viewport edge, full height, right border only (6% white), no rounded corners, no glass effect. Main content margin is exactly 260px when sidebar open. Collapse animation slides sidebar fully off-screen.
  </done>
</task>

<task type="auto">
  <name>Task 2: Restyle SidebarNavItem active state — coral left-border indicator</name>
  <files>
    src/components/app/sidebar-nav-item.tsx
  </files>
  <action>
    Replace the filled background active state (`bg-active text-foreground`) with a coral left-border indicator per user decision:

    1. Remove `bg-active` from the active state className.
    2. Add coral left-border indicator for active state: `border-l-2 border-accent` (2px coral left border).
    3. Add subtle background highlight for active state: `bg-white/[0.04]` (barely visible, not a solid fill like bg-active which is white/10%).
    4. For the inactive state: keep `text-foreground-secondary`, ensure no left-border is applied. Add `border-l-2 border-transparent` to maintain consistent spacing (so items don't shift when active/inactive).
    5. Keep the icon weight change (`fill` for active, `regular` for inactive) — good visual cue.
    6. Ensure the padding-left accounts for the border width so text alignment is consistent. The Button component should handle this, but verify the left border doesn't create a visual offset.
    7. Remove the `bg-active` reference from the component JSDoc comment — update to describe the new coral indicator pattern.
  </action>
  <verify>
    Run `npx tsc --noEmit` to confirm no type errors. Inspect: active nav item should show a 2px coral (#FF7F50) left border with a subtle bg-white/4% highlight. Inactive items should have transparent left border (same spacing). No filled background blocks on any nav item.
  </verify>
  <done>
    Active nav items show coral left-border indicator (2px) + subtle bg highlight (white/4%). Inactive items show no indicator. No filled background blocks. Text alignment is consistent across active/inactive states.
  </done>
</task>

<task type="auto">
  <name>Task 3: Restructure navigation items and reposition TikTok section</name>
  <files>
    src/components/app/sidebar.tsx
  </files>
  <action>
    **Remove duplicate Content Intelligence item:**
    1. Delete the entire `navItemsAfterSelector` array (contains "Content Intelligence" and "Referrals").
    2. Move "Referrals" into the main `navItems` array, placing it after "Trending".
    3. Final `navItems` array: `[Dashboard, Trending, Referrals]` — three items in top group.
    4. `bottomNavItems` stays as-is: `[Pricing]`.

    **Flatten navigation structure:**
    1. Remove the second `<nav>` block that rendered `navItemsAfterSelector`.
    2. The sidebar now has ONE top nav block rendering `navItems` (Dashboard, Trending, Referrals), a separator, and ONE bottom nav block rendering `bottomNavItems` (Pricing).
    3. No section labels — flat list, Raycast style.

    **Reposition TikTok account section:**
    1. Move the TikTok account section (both the connected state showing @handle AND the unconnected "Connect TikTok" prompt) from its current position between the two nav groups to ABOVE the top nav items.
    2. Position it after the header (logo + collapse button) and separator, before the nav items.
    3. Add a separator after the TikTok section and before the nav items.

    **Update isActive logic for Referrals:**
    1. For the "Referrals" item, use `pathname.startsWith("/referrals")` for isActive detection (same logic that was in navItemsAfterSelector).

    **Clean up imports:**
    1. Remove `Lightbulb` import from @phosphor-icons/react (was used by Content Intelligence).
    2. Keep all other imports.

    **Verify no broken references:**
    1. The navItems const type assertion (`as const`) should still work after adding Referrals.
    2. All router.push hrefs are valid routes: /dashboard, /trending, /referrals, /pricing.
  </action>
  <verify>
    Run `npx tsc --noEmit` to confirm no type errors and no unused imports. Run `npx next build` to verify route resolution. Inspect sidebar: should show TikTok section at top, then nav items (Dashboard, Trending, Referrals), spacer, then Pricing at bottom. No "Content Intelligence" item anywhere. No "Brand Deals" item (deferred to Phase 6).
  </verify>
  <done>
    Sidebar nav structure is: [TikTok section] -> separator -> [Dashboard, Trending, Referrals] -> spacer -> [Pricing]. "Content Intelligence" item is completely removed. No duplicate nav items. All hrefs route to valid pages. Lightbulb import removed.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` — zero type errors
2. `npx next build` — builds successfully with no warnings
3. Visual check: sidebar is solid dark (#07080a), flush left, right border only, no glass, no rounded corners
4. Visual check: active nav item has coral left-border indicator, not filled bg
5. Visual check: nav items are Dashboard, Trending, Referrals (top) and Pricing (bottom)
6. Visual check: no "Content Intelligence" nav item
7. Visual check: TikTok section is above nav items
8. Functional check: clicking each nav item routes to correct page (/dashboard, /trending, /referrals, /pricing)
9. Functional check: sidebar collapses fully off-screen, main content expands to full width
10. Functional check: mobile overlay still works (tap outside closes sidebar)
</verification>

<success_criteria>
- Sidebar is visually solid dark, flush to left edge, no glass effect, no rounded corners
- Active nav item uses coral left-border indicator (not filled bg block)
- Only Dashboard, Trending, Referrals, and Pricing nav items exist
- Content Intelligence item is removed
- TikTok section is above nav items
- All navigation routes work correctly
- Build passes with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-sidebar-navigation/01-01-SUMMARY.md`
</output>
