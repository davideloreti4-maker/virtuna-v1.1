---
phase: 15-ui-polish-remaining-gaps
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/app/simulation/results-panel.tsx
  - src/components/app/test-history-list.tsx
  - src/components/app/test-history-item.tsx
autonomous: true

must_haves:
  truths:
    - "Persona reactions placeholder is completely removed from results panel — no 'Audience Reactions' section visible"
    - "Analysis history items for video_upload analyses show a video icon indicator distinguishing them from text analyses"
    - "TestHistoryList passes input_mode from DB data to TestHistoryItem"
  artifacts:
    - path: "src/components/app/simulation/results-panel.tsx"
      provides: "Clean results panel with no persona placeholder"
      contains: "SuggestionsSection"
    - path: "src/components/app/test-history-list.tsx"
      provides: "History list passing input_mode to history items"
      contains: "inputMode"
  key_links:
    - from: "src/components/app/test-history-list.tsx"
      to: "src/components/app/test-history-item.tsx"
      via: "inputMode prop from DB input_mode column"
      pattern: "inputMode.*input_mode"
---

<objective>
Remove the persona reactions placeholder from the results panel and wire video analysis indicators into the history list.

Purpose: Close UI-06 (persona reactions) by clean removal since DeepSeek schema intentionally dropped persona_reactions in Phase 3. Close UI-08 (history thumbnails) by passing input_mode from the analysis_results DB data to TestHistoryItem so video analyses are visually distinguished. Since video_storage_path is not persisted in analysis_results, we use a Video icon indicator for video_upload items instead of actual thumbnails (no DB schema change needed).

Output: Clean results panel, history items with video mode indicator.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/components/app/simulation/results-panel.tsx
@src/components/app/test-history-list.tsx
@src/components/app/test-history-item.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove persona reactions placeholder from ResultsPanel</name>
  <files>src/components/app/simulation/results-panel.tsx</files>
  <action>
Remove the entire "Persona Reactions -- Placeholder" section from results-panel.tsx. This is lines 75-88 — the GlassCard with "Audience Reactions" heading and italic placeholder text.

Also remove the `Info` import from lucide-react since it's only used by the persona placeholder (AlertTriangle is still used by warnings). Remove the `GlassCard` import if no longer used elsewhere in the file (check — it's only used by the persona placeholder).

The result should be: warnings -> hero score -> factor breakdown -> behavioral predictions -> suggestions -> footer. No persona section at all.

Rationale: Personas were intentionally removed from the DeepSeek schema in Phase 3 (decision: "Dead v1 fields removed — persona_reactions, variants, conversation_themes"). The success criteria says "shows real personas OR is cleanly removed (no placeholder)." Clean removal is the correct path.
  </action>
  <verify>
    `grep -n "persona\|Audience Reactions\|will appear here once" src/components/app/simulation/results-panel.tsx` returns nothing.
    `grep -n "Info" src/components/app/simulation/results-panel.tsx` returns nothing (import removed).
    `pnpm build` compiles without errors.
  </verify>
  <done>Results panel renders: warnings, hero score, factor breakdown, behavioral predictions, suggestions, footer. No persona/audience reactions section exists.</done>
</task>

<task type="auto">
  <name>Task 2: Wire input_mode and video indicator to TestHistoryItem</name>
  <files>src/components/app/test-history-list.tsx, src/components/app/test-history-item.tsx</files>
  <action>
In `test-history-list.tsx`:
- Pass `inputMode` prop to each `TestHistoryItem` from the DB record's `input_mode` field: `inputMode={(test.input_mode as string) ?? 'text'}`
- Do NOT pass thumbnailUrl (video_storage_path is not persisted in analysis_results and generating signed URLs in a list is expensive)

In `test-history-item.tsx`:
- Update the video indicator section to show a small Video icon (from lucide-react) when `inputMode === 'video_upload'`, regardless of thumbnailUrl availability. This replaces the current `showThumbnail` logic that requires both inputMode AND thumbnailUrl.
- Keep the existing thumbnailUrl image rendering as a fallback for when thumbnailUrl IS available
- The logic should be:
  ```
  if (inputMode === 'video_upload' && thumbnailUrl) → show thumbnail image
  else if (inputMode === 'video_upload') → show Video icon in 8x8 rounded box
  else → show nothing (text analyses have no visual indicator)
  ```
- Import `Video` from `lucide-react`
- The Video icon container should use the same sizing as the thumbnail: `h-8 w-8 shrink-0 rounded bg-white/[0.05] flex items-center justify-center`
- Video icon itself: `h-4 w-4 text-foreground-muted`
  </action>
  <verify>
    `pnpm build` compiles without errors.
    `grep -n "inputMode" src/components/app/test-history-list.tsx` shows the prop being passed.
    `grep -n "Video" src/components/app/test-history-item.tsx` shows the icon import and usage.
  </verify>
  <done>History items for video_upload analyses show a Video icon indicator. Text analyses show no icon. When thumbnailUrl is available, the actual thumbnail image is shown instead of the icon.</done>
</task>

</tasks>

<verification>
1. `pnpm build` passes with zero errors
2. No persona/audience reactions section exists in results-panel.tsx
3. TestHistoryList passes inputMode to TestHistoryItem
4. TestHistoryItem renders Video icon for video_upload input_mode
</verification>

<success_criteria>
- Persona reactions placeholder completely removed (no "Audience Reactions" text anywhere in results-panel.tsx)
- Analysis history items visually distinguish video analyses from text analyses
- All imports clean — no unused imports
</success_criteria>

<output>
After completion, create `.planning/phases/15-ui-polish-remaining-gaps/15-01-SUMMARY.md`
</output>
