---
phase: 41-extended-components-raycast-patterns
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/tabs.tsx
  - src/components/ui/avatar.tsx
  - src/components/ui/divider.tsx
autonomous: true

must_haves:
  truths:
    - "Tabs switch content panels with arrow key navigation"
    - "Active tab shows glass pill styling (bg-white/5, border-white/10)"
    - "Avatar renders image with fallback initials when image fails to load"
    - "Avatar group displays overlapping avatars with +N count"
    - "Divider renders horizontal, vertical, and labeled variants"
  artifacts:
    - path: "src/components/ui/tabs.tsx"
      provides: "Tabs using Radix Tabs with Raycast pill styling"
      exports: ["Tabs", "TabsList", "TabsTrigger", "TabsContent"]
    - path: "src/components/ui/avatar.tsx"
      provides: "Avatar using Radix Avatar with sizes, fallback, group"
      exports: ["Avatar", "AvatarGroup", "AvatarProps"]
    - path: "src/components/ui/divider.tsx"
      provides: "Divider with horizontal, vertical, and labeled variants"
      exports: ["Divider", "DividerProps"]
  key_links:
    - from: "src/components/ui/tabs.tsx"
      to: "@radix-ui/react-tabs"
      via: "Radix primitive wrapping"
      pattern: "TabsPrimitive"
    - from: "src/components/ui/avatar.tsx"
      to: "@radix-ui/react-avatar"
      via: "Radix primitive wrapping"
      pattern: "AvatarPrimitive"
---

<objective>
Build Tabs, Avatar, and Divider components. Tabs and Avatar wrap Radix primitives; Divider is a simple styled component.

Purpose: Deliver accessible Tabs (CMX-04) with Raycast pill styling, Avatar (CMX-05) with image fallback and group support, and Divider (CMX-06) for layout separation.

Output: `tabs.tsx`, `avatar.tsx`, `divider.tsx` in `src/components/ui/`
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/41-extended-components-raycast-patterns/41-RESEARCH.md

# Reference primitives (for styling values)
@src/components/primitives/GlassTabs.tsx
@src/components/primitives/GlassAvatar.tsx
@src/components/primitives/Divider.tsx

# Established pattern
@src/components/ui/button.tsx
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Tabs component with Radix + Raycast pill styling</name>
  <files>src/components/ui/tabs.tsx</files>
  <action>
Create `src/components/ui/tabs.tsx` wrapping `@radix-ui/react-tabs` with Raycast pill tab styling from GlassTabs.

**Component parts to export:**
- `Tabs` = TabsPrimitive.Root (accepts `defaultValue`, `value`, `onValueChange`)
- `TabsList` — forwardRef wrapping TabsPrimitive.List. Styled: `inline-flex items-center gap-1 rounded-full border border-white/5 bg-surface-elevated p-1`. This creates the pill track background.
- `TabsTrigger` — forwardRef wrapping TabsPrimitive.Trigger. CVA variants for size (sm/md/lg).
  - Base: `inline-flex items-center justify-center whitespace-nowrap rounded-full px-4 py-1.5 text-sm font-medium transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/50 disabled:pointer-events-none disabled:opacity-50`
  - Active state (via `data-[state=active]:`): `bg-white/5 border border-white/10 text-foreground shadow-sm`
  - Inactive state: `text-foreground-secondary border border-transparent hover:text-foreground hover:bg-white/[0.03]`
  - Size sm: `px-3 py-1 text-xs`, md: `px-4 py-1.5 text-sm`, lg: `px-5 py-2 text-base`
- `TabsContent` — forwardRef wrapping TabsPrimitive.Content. Styled: `mt-4 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/50`.

**Pattern:** "use client", forwardRef, cn(), displayName, JSDoc. Radix handles roving tabindex, arrow key navigation, Home/End keys. Do NOT add custom keyboard handlers.
  </action>
  <verify>
`npx tsc --noEmit` — no type errors. Verify TabsPrimitive import from @radix-ui/react-tabs.
  </verify>
  <done>
Tabs component compiles, exports 4 parts, uses Radix Tabs for keyboard navigation, active tab has Raycast glass pill styling.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Avatar component with Radix + fallback + group</name>
  <files>src/components/ui/avatar.tsx</files>
  <action>
Create `src/components/ui/avatar.tsx` wrapping `@radix-ui/react-avatar` with sizes, fallback initials, and group layout.

**Avatar component:**
- Wrap `AvatarPrimitive.Root` with forwardRef
- CVA size variants: xs=`h-6 w-6`, sm=`h-8 w-8`, md=`h-10 w-10`, lg=`h-12 w-12`, xl=`h-16 w-16`
- Base: `relative inline-flex shrink-0 overflow-hidden rounded-full border border-border-glass bg-surface-elevated`
- `AvatarImage` — forwardRef wrapping AvatarPrimitive.Image, `aspect-square h-full w-full object-cover`
- `AvatarFallback` — forwardRef wrapping AvatarPrimitive.Fallback, `flex h-full w-full items-center justify-center bg-surface text-foreground-secondary font-medium`. Text size scales with avatar size.

**Avatar compound component interface:**
```typescript
interface AvatarProps {
  src?: string;
  alt?: string;
  fallback?: string;        // Initials like "DL"
  size?: "xs" | "sm" | "md" | "lg" | "xl";
  className?: string;
}
```

Provide a convenience `Avatar` component that composes Root + Image + Fallback internally, so usage is `<Avatar src="..." fallback="DL" size="md" />`. Also export the primitives for advanced use.

**AvatarGroup component:**
```typescript
interface AvatarGroupProps {
  children: React.ReactNode;  // Avatar elements
  max?: number;               // Max visible, rest shows +N
  size?: AvatarProps["size"];
  className?: string;
}
```
- Layout: `flex -space-x-2` (overlapping)
- Each avatar gets `ring-2 ring-bg-primary` for separation
- If children count > max, render a "+N" circle at the end with same size styling
- Export as `AvatarGroup`
  </action>
  <verify>
`npx tsc --noEmit` — no type errors. Verify AvatarPrimitive import from @radix-ui/react-avatar.
  </verify>
  <done>
Avatar component compiles with 5 sizes, Radix image loading/fallback, and AvatarGroup with overlap and +N count.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create Divider component</name>
  <files>src/components/ui/divider.tsx</files>
  <action>
Create `src/components/ui/divider.tsx` — a simple styled component (no Radix needed).

**Interface:**
```typescript
interface DividerProps extends React.HTMLAttributes<HTMLDivElement> {
  orientation?: "horizontal" | "vertical";
  label?: string;
  className?: string;
}
```

**CVA variants:**
- Horizontal (default): `w-full h-px bg-border` (uses semantic border token)
- Vertical: `h-full w-px bg-border`
- With label (horizontal only): Render as `flex items-center gap-4` with left line, label `<span className="text-xs text-foreground-tertiary whitespace-nowrap">`, right line. Lines are `flex-1 h-px bg-border`.

**Accessibility:** Add `role="separator"`, `aria-orientation` attribute.

**Pattern:** forwardRef, cn(), displayName, JSDoc. Simple component, no "use client" needed (no hooks/state).
  </action>
  <verify>
`npx tsc --noEmit` — no type errors. Verify role="separator" is present.
  </verify>
  <done>
Divider renders horizontal/vertical/labeled variants, uses semantic border token, has proper ARIA role.
  </done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes for all three files
- tabs.tsx imports from @radix-ui/react-tabs
- avatar.tsx imports from @radix-ui/react-avatar
- All files follow button.tsx pattern: forwardRef, cn(), displayName
- No manual keyboard handlers in tabs.tsx (Radix handles)
- No manual img onError in avatar.tsx (Radix handles fallback)
</verification>

<success_criteria>
- Tabs switch content with arrow keys, active tab has glass pill styling
- Avatar renders image and falls back to initials, AvatarGroup shows overlapping +N
- Divider separates content horizontally, vertically, or with a label
- All three use semantic tokens from globals.css
</success_criteria>

<output>
After completion, create `.planning/phases/41-extended-components-raycast-patterns/41-02-SUMMARY.md`
</output>
