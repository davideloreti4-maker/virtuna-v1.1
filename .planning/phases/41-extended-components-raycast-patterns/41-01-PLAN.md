---
phase: 41-extended-components-raycast-patterns
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/dialog.tsx
  - src/components/ui/toggle.tsx
autonomous: true

must_haves:
  truths:
    - "Dialog opens centered over a blurred dark overlay and closes on ESC or click-outside"
    - "Dialog traps focus within its content while open"
    - "Toggle switches between on/off with coral accent when checked"
    - "Toggle is keyboard accessible (Space to toggle)"
  artifacts:
    - path: "src/components/ui/dialog.tsx"
      provides: "Modal/Dialog using Radix Dialog with glass styling"
      exports: ["Dialog", "DialogTrigger", "DialogContent", "DialogHeader", "DialogFooter", "DialogTitle", "DialogDescription", "DialogClose"]
    - path: "src/components/ui/toggle.tsx"
      provides: "Toggle/Switch using Radix Switch with coral accent"
      exports: ["Toggle", "ToggleProps"]
  key_links:
    - from: "src/components/ui/dialog.tsx"
      to: "@radix-ui/react-dialog"
      via: "Radix primitive wrapping"
      pattern: "DialogPrimitive"
    - from: "src/components/ui/toggle.tsx"
      to: "@radix-ui/react-switch"
      via: "Radix primitive wrapping"
      pattern: "SwitchPrimitive"
---

<objective>
Build Dialog and Toggle components by wrapping Radix UI primitives with Raycast glass styling.

Purpose: Deliver accessible, focus-managed Dialog (CMX-02) and pixel-matched Toggle/Switch from CONTEXT.md, both using installed-but-unused Radix primitives instead of hand-rolling behavior.

Output: `dialog.tsx` and `toggle.tsx` in `src/components/ui/`
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/phases/41-extended-components-raycast-patterns/41-RESEARCH.md

# Reference primitives (for styling values, NOT behavior)
@src/components/primitives/GlassModal.tsx
@src/components/primitives/GlassToggle.tsx

# Established pattern (follow this CVA/forwardRef/JSDoc structure)
@src/components/ui/button.tsx

# Token system
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Dialog component with Radix + glass styling</name>
  <files>src/components/ui/dialog.tsx</files>
  <action>
Create `src/components/ui/dialog.tsx` wrapping `@radix-ui/react-dialog` with Raycast glass styling.

**Component parts to export:**
- `Dialog` = DialogPrimitive.Root
- `DialogTrigger` = DialogPrimitive.Trigger
- `DialogPortal` = DialogPrimitive.Portal
- `DialogClose` = DialogPrimitive.Close
- `DialogOverlay` — forwardRef, styled: `fixed inset-0 z-[var(--z-modal-backdrop)] bg-black/60 backdrop-blur-sm` with Radix open/close data-state animations (fade-in/fade-out). Include both `backdropFilter` and `WebkitBackdropFilter` as inline styles for Safari.
- `DialogContent` — forwardRef with `size` prop (`sm | md | lg | xl | full`). Styled: `fixed left-[50%] top-[50%] z-[var(--z-modal)] translate-x-[-50%] translate-y-[-50%] w-full rounded-xl border border-border-glass bg-surface-elevated shadow-xl`. Size mapping: sm=max-w-sm, md=max-w-md, lg=max-w-lg, xl=max-w-xl, full=max-w-[90vw] max-h-[90vh] overflow-auto. Glass effect via inline `backdropFilter: blur(20px)` + `WebkitBackdropFilter: blur(20px)`. Add scale-in/scale-out + fade animations using data-state.
- `DialogHeader` — `flex flex-col gap-1.5 p-6 pb-0`
- `DialogFooter` — `flex justify-end gap-3 p-6 pt-4`
- `DialogTitle` — forwardRef wrapping DialogPrimitive.Title, `text-lg font-semibold text-foreground`
- `DialogDescription` — forwardRef wrapping DialogPrimitive.Description, `text-sm text-foreground-secondary`

**Pattern:** Follow `button.tsx` structure: `"use client"`, forwardRef, cn(), displayName, JSDoc with examples. Do NOT hand-roll focus trap or scroll lock — Radix handles both.

**Animations:** Use Tailwind animate utilities: `data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0` for overlay. Content adds `data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=open]:slide-in-from-left-1/2`.

**Z-index:** Use `z-[var(--z-modal-backdrop)]` for overlay (300), `z-[var(--z-modal)]` for content (400). Do NOT use hardcoded z-50.
  </action>
  <verify>
Run `npx tsc --noEmit` — no type errors in dialog.tsx. Verify all Radix Dialog sub-components are properly wrapped and exported.
  </verify>
  <done>
Dialog component compiles with TypeScript, exports all 8 parts (Dialog, DialogTrigger, DialogContent, DialogHeader, DialogFooter, DialogTitle, DialogDescription, DialogClose), uses Radix Dialog under the hood (no manual focus trap), has glass styling with proper z-index tokens.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Toggle component with Radix Switch + coral accent</name>
  <files>src/components/ui/toggle.tsx</files>
  <action>
Create `src/components/ui/toggle.tsx` wrapping `@radix-ui/react-switch` with Raycast-matched styling.

**Interface:**
```typescript
interface ToggleProps extends React.ComponentPropsWithoutRef<typeof SwitchPrimitive.Root> {
  size?: "sm" | "md" | "lg";
  label?: string;
}
```

**CVA variants for the track (Root):**
- Base: `peer inline-flex shrink-0 cursor-pointer items-center rounded-full border transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/50 disabled:cursor-not-allowed disabled:opacity-50`
- Unchecked state: `bg-surface border-border-glass` (via `data-[state=unchecked]:`)
- Checked state: `bg-accent/20 border-accent/30` (via `data-[state=checked]:`)
- Size sm: `h-5 w-9`, md: `h-6 w-11`, lg: `h-7 w-[52px]`

**CVA variants for the thumb:**
- Base: `pointer-events-none block rounded-full shadow-sm transition-transform duration-200`
- Unchecked: `bg-foreground-secondary translate-x-0.5`
- Checked: `bg-accent translate-x-[calc(100%-2px)]` — with glow shadow `0 0 8px oklch(0.72 0.16 40 / 0.4)` via inline style when checked
- Size sm: `h-4 w-4`, md: `h-5 w-5`, lg: `h-6 w-6`

**Label:** If `label` prop provided, wrap in a `<label>` element with `flex items-center gap-3 cursor-pointer` and render label text as `<span className="text-sm text-foreground">`.

**Pattern:** forwardRef, "use client", cn(), displayName, JSDoc examples. Do NOT hand-roll state management — Radix Switch handles checked/onChange internally for both controlled and uncontrolled modes.
  </action>
  <verify>
Run `npx tsc --noEmit` — no type errors in toggle.tsx. Verify Toggle exports include ToggleProps type.
  </verify>
  <done>
Toggle component compiles, wraps Radix Switch (no manual state), has 3 sizes, coral accent when checked with glow shadow, optional label, keyboard accessible (Space to toggle).
  </done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes for both new files
- dialog.tsx uses `@radix-ui/react-dialog` (verify import exists)
- toggle.tsx uses `@radix-ui/react-switch` (verify import exists)
- No hardcoded z-index values in dialog.tsx (uses CSS var tokens)
- Both files include `WebkitBackdropFilter` where `backdropFilter` is used
- Both files follow button.tsx pattern: "use client", forwardRef, cn(), displayName
</verification>

<success_criteria>
- Dialog renders centered over blurred overlay, closes on ESC/click-outside, traps focus
- Toggle switches with coral accent when checked, keyboard accessible
- Both components use Radix primitives, not hand-rolled behavior
- Both use semantic tokens from globals.css
</success_criteria>

<output>
After completion, create `.planning/phases/41-extended-components-raycast-patterns/41-01-SUMMARY.md`
</output>
