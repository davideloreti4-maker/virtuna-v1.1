---
phase: 42-effects-animation
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/motion/stagger-reveal.tsx
  - src/components/motion/hover-scale.tsx
autonomous: true

must_haves:
  truths:
    - "StaggerReveal container triggers child animations with 80ms stagger delay"
    - "StaggerReveal uses whileInView with once:true for scroll-triggered stagger"
    - "StaggerReveal.Item wraps each child with fadeInUp item variants"
    - "HoverScale applies scale(1.02) on hover and scale(0.98) on tap"
    - "Both components respect prefers-reduced-motion"
  artifacts:
    - path: "src/components/motion/stagger-reveal.tsx"
      provides: "Stagger reveal container with compound component pattern"
      exports: ["StaggerReveal", "StaggerRevealProps"]
    - path: "src/components/motion/hover-scale.tsx"
      provides: "Hover scale micro-interaction wrapper"
      exports: ["HoverScale", "HoverScaleProps"]
  key_links:
    - from: "src/components/motion/stagger-reveal.tsx"
      to: "motion/react"
      via: "Motion variants + staggerChildren"
      pattern: "staggerChildren"
---

<objective>
Create StaggerReveal and HoverScale motion components.

Purpose: Add staggered reveal animation for lists/grids (Raycast extension grid pattern) and hover scale micro-interaction for interactive elements. Covers EFX-04 and EFX-05.
Output: New stagger-reveal.tsx and hover-scale.tsx in motion/.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/components/motion/fade-in.tsx
@.planning/phases/42-effects-animation/42-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create StaggerReveal compound component</name>
  <files>src/components/motion/stagger-reveal.tsx</files>
  <action>
Create `src/components/motion/stagger-reveal.tsx`:

1. "use client" directive.

2. Import `motion, useReducedMotion` from "motion/react" and `Variants` type.

3. Define container variants:
   ```typescript
   const containerVariants: Variants = {
     hidden: { opacity: 0 },
     visible: {
       opacity: 1,
       transition: {
         when: "beforeChildren",
         staggerChildren: 0.08,  // 80ms between children (Raycast pattern)
         delayChildren: 0.1,     // 100ms initial delay
       },
     },
   };
   ```

4. Define item variants:
   ```typescript
   const itemVariants: Variants = {
     hidden: { opacity: 0, y: 20 },
     visible: {
       opacity: 1,
       y: 0,
       transition: {
         duration: 0.5,
         ease: [0.25, 0.1, 0.25, 1.0],
       },
     },
   };
   ```

5. `StaggerRevealProps` interface:
   - `children: React.ReactNode`
   - `className?: string`
   - `staggerDelay?: number` — default 0.08 (80ms)
   - `initialDelay?: number` — default 0.1 (100ms)
   - `once?: boolean` — default true
   - `as?: React.ElementType` — default "div"

6. `StaggerReveal` component:
   - Check `useReducedMotion()` — if true, render children in a plain div.
   - Otherwise render `motion.div` with:
     - `initial="hidden"`
     - `whileInView="visible"`
     - `viewport={{ once, margin: "-50px" }}`
     - Custom container variants using `staggerDelay` and `initialDelay` props.

7. `StaggerRevealItemProps` interface:
   - `children: React.ReactNode`
   - `className?: string`

8. `StaggerRevealItem` component — simple `motion.div` with `variants={itemVariants}`.

9. Attach as compound component: `StaggerReveal.Item = StaggerRevealItem`.

10. Export `StaggerReveal`, `StaggerRevealProps`, and `StaggerRevealItem` (for direct import if needed).

11. JSDoc with @example showing grid usage:
```
<StaggerReveal className="grid grid-cols-3 gap-4">
  <StaggerReveal.Item>Card 1</StaggerReveal.Item>
  <StaggerReveal.Item>Card 2</StaggerReveal.Item>
  <StaggerReveal.Item>Card 3</StaggerReveal.Item>
</StaggerReveal>
```
  </action>
  <verify>Run `pnpm build` — compiles without errors. StaggerReveal and StaggerReveal.Item exported. Container uses staggerChildren: 0.08, items use fadeInUp variants.</verify>
  <done>StaggerReveal container orchestrates child animations with 80ms stagger delay, scroll-triggered via whileInView. Compound component pattern matches React conventions.</done>
</task>

<task type="auto">
  <name>Task 2: Create HoverScale micro-interaction</name>
  <files>src/components/motion/hover-scale.tsx</files>
  <action>
Create `src/components/motion/hover-scale.tsx`:

1. "use client" directive.

2. Import `motion, useReducedMotion` from "motion/react".

3. `HoverScaleProps` interface:
   - `children: React.ReactNode`
   - `className?: string`
   - `scale?: number` — default 1.02
   - `tapScale?: number` — default 0.98
   - `as?: React.ElementType` — default "div"

4. Component implementation:
   - Check `useReducedMotion()`.
   - If reduced motion: render plain element with className, no animation.
   - Otherwise render `motion.div` with:
     - `whileHover={{ scale }}` — subtle scale up
     - `whileTap={{ scale: tapScale }}` — slight press-in
     - `transition={{ type: "spring", stiffness: 400, damping: 25 }}` — snappy spring feel
   - Use cn() for className merging.

5. Export `HoverScale` and `HoverScaleProps`.

6. JSDoc with @example showing card hover usage.

This is a simple wrapper — no variants, no viewport detection. Pure hover/tap interaction.
  </action>
  <verify>Run `pnpm build` — compiles without errors. HoverScale exported with correct spring transition. Reduced motion check present.</verify>
  <done>HoverScale wraps content with scale(1.02) on hover and scale(0.98) on tap using spring physics. Respects prefers-reduced-motion.</done>
</task>

</tasks>

<verification>
- `pnpm build` passes
- StaggerReveal uses staggerChildren: 0.08, delayChildren: 0.1
- StaggerReveal.Item uses opacity + translateY item variants
- StaggerReveal triggers on viewport entry (whileInView, once:true)
- HoverScale uses spring transition (stiffness 400, damping 25)
- Both components check useReducedMotion()
</verification>

<success_criteria>
StaggerReveal provides orchestrated child animation for grids/lists. HoverScale provides micro-interaction for interactive elements. EFX-04 and EFX-05 requirements satisfied.
</success_criteria>

<output>
After completion, create `.planning/phases/42-effects-animation/42-04-SUMMARY.md`
</output>
