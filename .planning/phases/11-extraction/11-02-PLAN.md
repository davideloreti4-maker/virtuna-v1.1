---
phase: 11-extraction
plan: 02
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - extraction/scripts/capture-dashboard.ts
  - extraction/scripts/capture-navigation.ts
autonomous: true

must_haves:
  truths:
    - "Dashboard default state captured at both viewports"
    - "Dashboard with society selected captured at both viewports"
    - "Sidebar navigation states captured (expanded, collapsed where applicable)"
    - "Network visualization area captured"
  artifacts:
    - path: "extraction/screenshots/desktop/dashboard/default.png"
      provides: "Dashboard default state at 1440px"
    - path: "extraction/screenshots/desktop/dashboard/society-selected.png"
      provides: "Dashboard with society selected"
    - path: "extraction/screenshots/mobile/dashboard/default.png"
      provides: "Dashboard default state at 375px"
    - path: "extraction/scripts/capture-dashboard.ts"
      provides: "Dashboard capture script"
      contains: "captureScreen"
  key_links:
    - from: "extraction/scripts/capture-dashboard.ts"
      to: "extraction/scripts/utils.ts"
      via: "import"
      pattern: "from.*utils"
---

<objective>
Extract dashboard and navigation states from app.societies.io at desktop and mobile viewports.

Purpose: Capture the core app interface — dashboard layout, sidebar, and network visualization — in all relevant states for Phase 12 comparison.
Output: Screenshots of dashboard default state, society selected state, and sidebar navigation at both viewports.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/11-extraction/11-CONTEXT.md
@.planning/phases/11-extraction/11-RESEARCH.md
@.planning/phases/11-extraction/11-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create dashboard capture script</name>
  <files>
    - extraction/scripts/capture-dashboard.ts
  </files>
  <action>
Create extraction/scripts/capture-dashboard.ts that captures:

1. **Dashboard default state** (no test running, default society):
   - Desktop (1440px): `screenshots/desktop/dashboard/default.png`
   - Mobile (375px): `screenshots/mobile/dashboard/default.png`

2. **Dashboard with society selected** (if different societies available):
   - Desktop: `screenshots/desktop/dashboard/society-selected.png`
   - Mobile: `screenshots/mobile/dashboard/society-selected.png`

3. **Dashboard loading state** (if observable — may require timing):
   - Desktop: `screenshots/desktop/dashboard/loading.png`

Script structure:
```typescript
import { chromium } from 'playwright';
import { VIEWPORTS, ViewportName, captureScreen, createAuthContext, scrollToBottom } from './utils';

async function captureDashboard() {
  const browser = await chromium.launch();

  for (const viewport of ['desktop', 'mobile'] as ViewportName[]) {
    const context = await createAuthContext(browser, viewport);
    const page = await context.newPage();

    // Navigate to dashboard
    await page.goto('https://app.societies.io/dashboard');
    await page.waitForLoadState('networkidle');

    // 1. Default state
    await captureScreen(page, viewport, 'dashboard', 'main', 'default');

    // 2. If society selector exists and can select a different society
    // Click society selector to see if it opens
    const societySelector = page.locator('[data-testid="society-selector"], .society-selector, button:has-text("Select Society")');
    if (await societySelector.isVisible()) {
      // Capture any society-selected state if we can observe a difference
      // This depends on the app state
    }

    await context.close();
  }

  await browser.close();
  console.log('Dashboard capture complete!');
}

captureDashboard().catch(console.error);
```

Important:
- Use `scrollToBottom()` before each capture per CONTEXT.md requirement
- Wait for `networkidle` to ensure all content loaded
- Log each captured screenshot path

  </action>
  <verify>
Run script: `npx ts-node extraction/scripts/capture-dashboard.ts`
Screenshots created in:
- extraction/screenshots/desktop/dashboard/
- extraction/screenshots/mobile/dashboard/
  </verify>
  <done>
- Dashboard default state captured at desktop and mobile viewports
- All captures scroll to bottom before screenshot
- Files organized in proper folder structure
  </done>
</task>

<task type="auto">
  <name>Task 2: Create navigation and sidebar capture script</name>
  <files>
    - extraction/scripts/capture-navigation.ts
  </files>
  <action>
Create extraction/scripts/capture-navigation.ts that captures:

1. **Sidebar states**:
   - Desktop default: `screenshots/desktop/navigation/sidebar-default.png`
   - Desktop with hover on nav items: `screenshots/desktop/navigation/sidebar-hover-{item}.png`

2. **Mobile navigation**:
   - Hamburger menu closed: `screenshots/mobile/navigation/drawer-closed.png`
   - Hamburger menu open: `screenshots/mobile/navigation/drawer-open.png`

3. **Network visualization area**:
   - Default state: `screenshots/desktop/dashboard/network-default.png`
   - With filter pills visible: `screenshots/desktop/dashboard/network-with-filters.png`

Script approach:
```typescript
import { chromium } from 'playwright';
import { VIEWPORTS, ViewportName, captureScreen, createAuthContext } from './utils';

async function captureNavigation() {
  const browser = await chromium.launch();

  // Desktop sidebar
  {
    const context = await createAuthContext(browser, 'desktop');
    const page = await context.newPage();
    await page.goto('https://app.societies.io/dashboard');
    await page.waitForLoadState('networkidle');

    // Sidebar default
    await captureScreen(page, 'desktop', 'navigation', 'sidebar', 'default');

    // Sidebar with hover states on nav items
    const navItems = page.locator('nav a, nav button, [role="navigation"] a');
    const count = await navItems.count();
    for (let i = 0; i < Math.min(count, 5); i++) {
      const item = navItems.nth(i);
      const text = (await item.textContent())?.trim().toLowerCase().replace(/\s+/g, '-') || `item-${i}`;
      await item.hover();
      await page.screenshot({ path: `./extraction/screenshots/desktop/navigation/sidebar-hover-${text}.png` });
    }

    await context.close();
  }

  // Mobile drawer
  {
    const context = await createAuthContext(browser, 'mobile');
    const page = await context.newPage();
    await page.goto('https://app.societies.io/dashboard');
    await page.waitForLoadState('networkidle');

    // Drawer closed
    await captureScreen(page, 'mobile', 'navigation', 'drawer', 'closed');

    // Open drawer (hamburger menu)
    const hamburger = page.locator('[data-testid="mobile-menu"], button[aria-label*="menu"], .hamburger, [class*="hamburger"]');
    if (await hamburger.isVisible()) {
      await hamburger.click();
      await page.waitForTimeout(300); // Allow drawer animation
      await captureScreen(page, 'mobile', 'navigation', 'drawer', 'open');
    }

    await context.close();
  }

  await browser.close();
  console.log('Navigation capture complete!');
}

captureNavigation().catch(console.error);
```

  </action>
  <verify>
Run script: `npx ts-node extraction/scripts/capture-navigation.ts`
Screenshots created in:
- extraction/screenshots/desktop/navigation/
- extraction/screenshots/mobile/navigation/
  </verify>
  <done>
- Sidebar default and hover states captured at desktop
- Mobile drawer open/closed states captured
- All navigation elements documented for Phase 12 comparison
  </done>
</task>

</tasks>

<verification>
- [ ] `extraction/scripts/capture-dashboard.ts` exists and runs without error
- [ ] `extraction/scripts/capture-navigation.ts` exists and runs without error
- [ ] Screenshots exist in `extraction/screenshots/desktop/dashboard/`
- [ ] Screenshots exist in `extraction/screenshots/mobile/dashboard/`
- [ ] Screenshots exist in `extraction/screenshots/desktop/navigation/`
- [ ] Screenshots exist in `extraction/screenshots/mobile/navigation/`
</verification>

<success_criteria>
- Dashboard captured at both viewports in default state
- Navigation/sidebar captured with hover states
- Mobile drawer captured open and closed
- All screenshots organized for easy Phase 12 comparison
</success_criteria>

<output>
After completion, create `.planning/phases/11-extraction/11-02-SUMMARY.md`
</output>
