---
phase: 09-settings-modals
plan: 02
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - src/components/app/settings/settings-page.tsx
  - src/components/app/settings/profile-section.tsx
  - src/components/app/settings/account-section.tsx
autonomous: true

must_haves:
  truths:
    - "User can see settings page with tabbed navigation"
    - "User can view and edit their profile information"
    - "User can see account settings section"
  artifacts:
    - path: "src/components/app/settings/settings-page.tsx"
      provides: "Main settings container with Radix Tabs"
      exports: ["SettingsPage"]
    - path: "src/components/app/settings/profile-section.tsx"
      provides: "Profile editing form"
      exports: ["ProfileSection"]
    - path: "src/components/app/settings/account-section.tsx"
      provides: "Account settings display"
      exports: ["AccountSection"]
  key_links:
    - from: "src/components/app/settings/settings-page.tsx"
      to: "@radix-ui/react-tabs"
      via: "Tabs.Root, Tabs.List, Tabs.Content"
      pattern: "Tabs\\.(Root|List|Trigger|Content)"
    - from: "src/components/app/settings/profile-section.tsx"
      to: "src/stores/settings-store.ts"
      via: "useSettingsStore hook"
      pattern: "useSettingsStore"
---

<objective>
Build the settings page structure with Radix Tabs and the profile/account sections.

Purpose: Create the foundational settings UI that users navigate to manage their account.
Output: Working settings page with profile editing and account information display.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/09-settings-modals/09-RESEARCH.md

# Store for settings data
@src/stores/settings-store.ts

# Reference for component patterns
@src/components/app/society-selector.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Settings Page with Tabs</name>
  <files>src/components/app/settings/settings-page.tsx</files>
  <action>
**CRITICAL: Use v0 MCP to design the settings page layout before implementing.**

Query v0 with: "Settings page with vertical tabs on left side, dark theme zinc-900 background, tabs for Profile, Account, Notifications, Billing, Team. Match societies.io styling."

Create the main settings page container using Radix Tabs:

```typescript
"use client";

import { useEffect } from "react";
import * as Tabs from "@radix-ui/react-tabs";
import { User, Settings, Bell, CreditCard, Users } from "lucide-react";
import { cn } from "@/lib/utils";
import { useSettingsStore } from "@/stores/settings-store";
import { ProfileSection } from "./profile-section";
import { AccountSection } from "./account-section";
// Import other sections as they're created

interface SettingsPageProps {
  defaultTab?: string;
}

const TABS = [
  { value: "profile", label: "Profile", icon: User },
  { value: "account", label: "Account", icon: Settings },
  { value: "notifications", label: "Notifications", icon: Bell },
  { value: "billing", label: "Billing", icon: CreditCard },
  { value: "team", label: "Team", icon: Users },
] as const;

export function SettingsPage({ defaultTab = "profile" }: SettingsPageProps) {
  const _hydrate = useSettingsStore((s) => s._hydrate);
  const _isHydrated = useSettingsStore((s) => s._isHydrated);

  // Hydrate store on mount
  useEffect(() => {
    _hydrate();
  }, [_hydrate]);

  if (!_isHydrated) {
    return (
      <div className="flex h-full items-center justify-center">
        <div className="h-8 w-8 animate-spin rounded-full border-2 border-zinc-700 border-t-white" />
      </div>
    );
  }

  return (
    <div className="mx-auto max-w-4xl p-6">
      <h1 className="mb-8 text-2xl font-semibold text-white">Settings</h1>

      <Tabs.Root defaultValue={defaultTab} orientation="vertical" className="flex gap-8">
        {/* Tab List - Left side */}
        <Tabs.List className="flex w-48 flex-shrink-0 flex-col gap-1">
          {TABS.map((tab) => (
            <Tabs.Trigger
              key={tab.value}
              value={tab.value}
              className={cn(
                "flex items-center gap-3 rounded-lg px-4 py-3 text-left text-sm font-medium transition-colors",
                "text-zinc-400 hover:bg-zinc-800/50 hover:text-zinc-300",
                "data-[state=active]:bg-zinc-800 data-[state=active]:text-white"
              )}
            >
              <tab.icon className="h-4 w-4" />
              {tab.label}
            </Tabs.Trigger>
          ))}
        </Tabs.List>

        {/* Tab Content - Right side */}
        <div className="flex-1">
          <Tabs.Content value="profile" className="outline-none">
            <ProfileSection />
          </Tabs.Content>
          <Tabs.Content value="account" className="outline-none">
            <AccountSection />
          </Tabs.Content>
          <Tabs.Content value="notifications" className="outline-none">
            <div className="text-zinc-400">Notifications section - Plan 03</div>
          </Tabs.Content>
          <Tabs.Content value="billing" className="outline-none">
            <div className="text-zinc-400">Billing section - Plan 04</div>
          </Tabs.Content>
          <Tabs.Content value="team" className="outline-none">
            <div className="text-zinc-400">Team section - Plan 03</div>
          </Tabs.Content>
        </div>
      </Tabs.Root>
    </div>
  );
}
```

Key patterns:
- Vertical tabs layout (orientation="vertical")
- Lucide icons for each tab
- data-[state=active] for active tab styling
- Hydration check before rendering content
  </action>
  <verify>Component renders without errors when imported</verify>
  <done>Settings page with 5 tabs, vertical navigation, profile and account sections connected</done>
</task>

<task type="auto">
  <name>Task 2: Create Profile Section</name>
  <files>src/components/app/settings/profile-section.tsx</files>
  <action>
**CRITICAL: Use v0 MCP to design the profile form before implementing.**

Query v0 with: "Profile settings form with avatar, name input, email input, company input, role input. Dark theme, zinc-900 background, zinc-800 inputs. Save button at bottom."

Create the profile editing section:

```typescript
"use client";

import { useState, useEffect } from "react";
import * as Avatar from "@radix-ui/react-avatar";
import { useSettingsStore } from "@/stores/settings-store";
import { Input } from "@/components/ui";

export function ProfileSection() {
  const profile = useSettingsStore((s) => s.profile);
  const updateProfile = useSettingsStore((s) => s.updateProfile);

  // Local form state
  const [name, setName] = useState(profile.name);
  const [email, setEmail] = useState(profile.email);
  const [company, setCompany] = useState(profile.company || "");
  const [role, setRole] = useState(profile.role || "");
  const [isSaving, setIsSaving] = useState(false);
  const [saved, setSaved] = useState(false);

  // Sync local state when profile changes
  useEffect(() => {
    setName(profile.name);
    setEmail(profile.email);
    setCompany(profile.company || "");
    setRole(profile.role || "");
  }, [profile]);

  const handleSave = async () => {
    setIsSaving(true);
    // Simulate API delay
    await new Promise((r) => setTimeout(r, 500));
    updateProfile({ name, email, company, role });
    setIsSaving(false);
    setSaved(true);
    setTimeout(() => setSaved(false), 2000);
  };

  // Get initials for avatar fallback
  const initials = name
    .split(" ")
    .map((n) => n[0])
    .join("")
    .toUpperCase()
    .slice(0, 2);

  return (
    <div className="space-y-8">
      <div>
        <h2 className="text-lg font-medium text-white">Profile</h2>
        <p className="mt-1 text-sm text-zinc-400">
          Manage your personal information and how others see you.
        </p>
      </div>

      {/* Avatar */}
      <div className="flex items-center gap-4">
        <Avatar.Root className="h-20 w-20 overflow-hidden rounded-full bg-zinc-800">
          <Avatar.Image
            src={profile.avatar}
            alt={name}
            className="h-full w-full object-cover"
          />
          <Avatar.Fallback className="flex h-full w-full items-center justify-center text-lg font-medium text-zinc-400">
            {initials}
          </Avatar.Fallback>
        </Avatar.Root>
        <div>
          <button
            type="button"
            className="rounded-lg border border-zinc-700 bg-zinc-800 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-zinc-700"
          >
            Change avatar
          </button>
          <p className="mt-2 text-xs text-zinc-500">JPG, PNG or GIF. Max 2MB.</p>
        </div>
      </div>

      {/* Form fields */}
      <div className="grid gap-6 sm:grid-cols-2">
        <div>
          <label className="mb-2 block text-sm font-medium text-zinc-300">
            Full name
          </label>
          <Input
            value={name}
            onChange={(e) => setName(e.target.value)}
            placeholder="Your name"
          />
        </div>
        <div>
          <label className="mb-2 block text-sm font-medium text-zinc-300">
            Email address
          </label>
          <Input
            type="email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            placeholder="you@example.com"
          />
        </div>
        <div>
          <label className="mb-2 block text-sm font-medium text-zinc-300">
            Company
          </label>
          <Input
            value={company}
            onChange={(e) => setCompany(e.target.value)}
            placeholder="Your company"
          />
        </div>
        <div>
          <label className="mb-2 block text-sm font-medium text-zinc-300">
            Role
          </label>
          <Input
            value={role}
            onChange={(e) => setRole(e.target.value)}
            placeholder="Your role"
          />
        </div>
      </div>

      {/* Save button */}
      <div className="flex items-center gap-4">
        <button
          type="button"
          onClick={handleSave}
          disabled={isSaving}
          className="rounded-lg bg-white px-6 py-2.5 text-sm font-medium text-zinc-900 transition-colors hover:bg-zinc-200 disabled:opacity-50"
        >
          {isSaving ? "Saving..." : "Save changes"}
        </button>
        {saved && (
          <span className="text-sm text-emerald-400">Changes saved!</span>
        )}
      </div>
    </div>
  );
}
```

Key patterns:
- Radix Avatar with fallback to initials
- Local form state synced with store
- Save button with loading/success states
- Grid layout for form fields
  </action>
  <verify>Profile section renders and save button updates store</verify>
  <done>Profile section with avatar, form fields, and working save functionality</done>
</task>

<task type="auto">
  <name>Task 3: Create Account Section</name>
  <files>src/components/app/settings/account-section.tsx</files>
  <action>
**CRITICAL: Use v0 MCP to design the account section before implementing.**

Query v0 with: "Account settings section with email change, password change, delete account button. Dark theme, danger zone at bottom with red delete button."

Create the account settings section:

```typescript
"use client";

import { useState } from "react";
import { Input } from "@/components/ui";
import { useSettingsStore } from "@/stores/settings-store";

export function AccountSection() {
  const profile = useSettingsStore((s) => s.profile);

  const [currentPassword, setCurrentPassword] = useState("");
  const [newPassword, setNewPassword] = useState("");
  const [confirmPassword, setConfirmPassword] = useState("");

  const handlePasswordChange = () => {
    // Mock - would call API in real app
    console.log("Password change requested");
    setCurrentPassword("");
    setNewPassword("");
    setConfirmPassword("");
  };

  const handleDeleteAccount = () => {
    // Mock - would show confirmation modal
    console.log("Delete account requested");
  };

  return (
    <div className="space-y-8">
      <div>
        <h2 className="text-lg font-medium text-white">Account</h2>
        <p className="mt-1 text-sm text-zinc-400">
          Manage your account settings and security preferences.
        </p>
      </div>

      {/* Email section */}
      <div className="rounded-lg border border-zinc-800 bg-zinc-900/50 p-6">
        <h3 className="text-sm font-medium text-white">Email address</h3>
        <p className="mt-1 text-sm text-zinc-400">
          Your email is used for login and notifications.
        </p>
        <div className="mt-4 flex items-center gap-4">
          <Input
            type="email"
            value={profile.email}
            disabled
            className="max-w-sm opacity-70"
          />
          <button
            type="button"
            className="rounded-lg border border-zinc-700 bg-zinc-800 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-zinc-700"
          >
            Change email
          </button>
        </div>
      </div>

      {/* Password section */}
      <div className="rounded-lg border border-zinc-800 bg-zinc-900/50 p-6">
        <h3 className="text-sm font-medium text-white">Change password</h3>
        <p className="mt-1 text-sm text-zinc-400">
          Update your password to keep your account secure.
        </p>
        <div className="mt-4 space-y-4">
          <div className="max-w-sm">
            <label className="mb-2 block text-sm text-zinc-400">
              Current password
            </label>
            <Input
              type="password"
              value={currentPassword}
              onChange={(e) => setCurrentPassword(e.target.value)}
              placeholder="Enter current password"
            />
          </div>
          <div className="max-w-sm">
            <label className="mb-2 block text-sm text-zinc-400">
              New password
            </label>
            <Input
              type="password"
              value={newPassword}
              onChange={(e) => setNewPassword(e.target.value)}
              placeholder="Enter new password"
            />
          </div>
          <div className="max-w-sm">
            <label className="mb-2 block text-sm text-zinc-400">
              Confirm new password
            </label>
            <Input
              type="password"
              value={confirmPassword}
              onChange={(e) => setConfirmPassword(e.target.value)}
              placeholder="Confirm new password"
            />
          </div>
          <button
            type="button"
            onClick={handlePasswordChange}
            className="rounded-lg bg-white px-4 py-2 text-sm font-medium text-zinc-900 transition-colors hover:bg-zinc-200"
          >
            Update password
          </button>
        </div>
      </div>

      {/* Danger zone */}
      <div className="rounded-lg border border-red-900/50 bg-red-950/20 p-6">
        <h3 className="text-sm font-medium text-red-400">Danger zone</h3>
        <p className="mt-1 text-sm text-zinc-400">
          Once you delete your account, there is no going back. Please be certain.
        </p>
        <button
          type="button"
          onClick={handleDeleteAccount}
          className="mt-4 rounded-lg border border-red-700 bg-red-900/30 px-4 py-2 text-sm font-medium text-red-400 transition-colors hover:bg-red-900/50"
        >
          Delete account
        </button>
      </div>
    </div>
  );
}
```

Key patterns:
- Sections with card-like containers
- Password fields with proper types
- Danger zone with red styling for destructive action
- Console.log stubs for actions (mock implementation)
  </action>
  <verify>Account section renders with all three sections (email, password, danger zone)</verify>
  <done>Account section with email display, password change form, and delete account danger zone</done>
</task>

</tasks>

<verification>
1. Run `npx tsc --noEmit` - no TypeScript errors
2. Import SettingsPage in a test file - renders without errors
3. Tabs navigation works - clicking tabs shows different content
4. Profile form save button updates store
</verification>

<success_criteria>
- Settings page renders with 5 tabs (Profile, Account, Notifications, Billing, Team)
- Profile section shows avatar, name, email, company, role fields
- Profile save button persists changes to localStorage
- Account section shows email, password change, delete account
- v0 MCP used for design verification
</success_criteria>

<output>
After completion, create `.planning/phases/09-settings-modals/09-02-SUMMARY.md`
</output>
