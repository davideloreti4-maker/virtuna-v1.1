---
phase: 04-app-layout-navigation
plan: 04
type: execute
wave: 3
depends_on: ["04-02"]
files_modified:
  - src/components/app/network-visualization.tsx
  - src/components/app/filter-pills.tsx
  - src/components/app/context-bar.tsx
  - src/app/(app)/dashboard/page.tsx
  - src/components/app/index.ts
autonomous: true

must_haves:
  truths:
    - "Network visualization area shows animated dots"
    - "Filter pills display at top of visualization area"
    - "Context bar shows location label (Switzerland)"
    - "Animation respects prefers-reduced-motion"
  artifacts:
    - path: "src/components/app/network-visualization.tsx"
      provides: "Canvas-based animated dots"
      contains: "canvas"
      min_lines: 60
    - path: "src/components/app/filter-pills.tsx"
      provides: "Filter pill components"
      exports: ["FilterPill", "FilterPillGroup"]
    - path: "src/components/app/context-bar.tsx"
      provides: "Top context bar with label"
  key_links:
    - from: "src/app/(app)/dashboard/page.tsx"
      to: "src/components/app/network-visualization.tsx"
      via: "import and render"
      pattern: "NetworkVisualization"
---

<objective>
Build the network visualization placeholder and filter pills for the dashboard main area.

Purpose: Create the visual centerpiece of the dashboard - an animated dot visualization with a context bar and filter pills legend. This is a placeholder for the real network visualization (Phase 7+).

Output: Dashboard page with network visualization, context bar, and filter pills.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/04-app-layout-navigation/04-RESEARCH.md
@.planning/phases/04-app-layout-navigation/04-CONTEXT.md
@.reference/app/dashboard.md
@.reference/app/view-selector.md
@src/app/(app)/dashboard/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create NetworkVisualization component</name>
  <files>src/components/app/network-visualization.tsx</files>
  <action>
Create a canvas-based animated dots visualization as placeholder for the real network.

**Component structure:**
```typescript
"use client";

import { useEffect, useRef } from "react";

interface Dot {
  x: number;
  y: number;
  vx: number;
  vy: number;
  radius: number;
  color: string;
}

interface NetworkVisualizationProps {
  className?: string;
}
```

**Canvas setup:**
- Use useRef for canvas element
- Handle resize with ResizeObserver or window resize event
- Scale for device pixel ratio (crisp on retina)

**Dot animation:**
- Initialize ~50 dots with random positions
- Colors from ROLE_LEVEL palette:
  - Indigo: #6366F1 (25%)
  - Pink: #EC4899 (25%)
  - Emerald: #10B981 (25%)
  - Orange: #F97316 (25%)
- Random radius: 3-8px
- Slow velocity: (Math.random() - 0.5) * 0.3
- Bounce off edges

**Reduced motion support:**
```typescript
const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;

if (!prefersReducedMotion) {
  // Update positions
}
```

**Animation loop:**
- requestAnimationFrame for smooth 60fps
- Clear and redraw each frame
- Cleanup on unmount

**Styling:**
- Canvas fills container (absolute inset-0)
- aria-hidden="true" (decorative)

**Optional enhancements:**
- Subtle glow effect on dots (ctx.shadowBlur)
- Draw faint connection lines between nearby dots
  </action>
  <verify>
1. Component renders without errors
2. Dots animate smoothly
3. No memory leaks (check dev tools)
4. Respects prefers-reduced-motion
  </verify>
  <done>
- NetworkVisualization renders animated dots
- Colors match role level palette
- Animation is smooth (~60fps)
- Accessibility: reduced motion respected
  </done>
</task>

<task type="auto">
  <name>Task 2: Create FilterPill and ContextBar components</name>
  <files>
    src/components/app/filter-pills.tsx
    src/components/app/context-bar.tsx
  </files>
  <action>
**FilterPill component:**
```typescript
interface FilterPillProps {
  label: string;
  color: string;
  active?: boolean;
  onClick?: () => void;
}
```

Styling from research:
- Rounded-full pill shape
- Border: zinc-800 (inactive) or zinc-600 (active)
- Background: zinc-900/50 (inactive) or zinc-800/50 (active)
- Color dot on left (2.5w x 2.5h, rounded-full)
- Text: zinc-400 (inactive) or white (active)
- px-4 py-1.5, text-sm
- Hover: text-white

**FilterPillGroup component:**
```typescript
interface FilterPillGroupProps {
  className?: string;
}
```

Uses ROLE_LEVELS data:
```typescript
const ROLE_LEVELS = [
  { label: "Executive Level", color: "#6366F1" },
  { label: "Mid Level", color: "#EC4899" },
  { label: "Senior Level", color: "#10B981" },
  { label: "Entry Level", color: "#F97316" },
];
```

- Renders all 4 pills in a flex row with gap-2
- Manages active state internally (all active by default)
- Toggle on click (visual only - no filtering logic)

**ContextBar component:**
```typescript
interface ContextBarProps {
  location?: string;
  className?: string;
}
```

Styling:
- Positioned at top of visualization area
- Contains location pill (e.g., "Switzerland")
- Location pill: bg-zinc-800/80, border border-zinc-700, rounded-full, px-4 py-2
- Color dot (optional) + label text
- Flex centered

Default location: "Switzerland" (hardcoded demo)
  </action>
  <verify>
1. FilterPill renders with color dot and label
2. FilterPillGroup shows 4 pills
3. Clicking pill toggles active state
4. ContextBar shows "Switzerland" label
  </verify>
  <done>
- FilterPill and FilterPillGroup components working
- ContextBar displays location
- Toggle state works on pills
  </done>
</task>

<task type="auto">
  <name>Task 3: Assemble Dashboard page</name>
  <files>
    src/app/(app)/dashboard/page.tsx
    src/components/app/index.ts
  </files>
  <action>
Compose all components into the dashboard page.

**Dashboard layout:**
```tsx
export default function DashboardPage() {
  return (
    <div className="relative flex h-full flex-col">
      {/* Top bar with context and filters */}
      <div className="relative z-10 flex items-center justify-between px-6 py-4">
        <ContextBar location="Switzerland" />
        <FilterPillGroup />
      </div>

      {/* Network visualization fills remaining space */}
      <div className="relative flex-1">
        <NetworkVisualization />
      </div>

      {/* Accessibility */}
      <h1 className="sr-only">Dashboard</h1>
    </div>
  );
}
```

**Key layout details:**
- Container is relative, full height
- Top bar is relative z-10 (above canvas)
- Context bar on left, filters on right
- Network viz container is relative flex-1
- Canvas is absolute within viz container

**Update barrel exports:**
```typescript
export { NetworkVisualization } from "./network-visualization";
export { FilterPill, FilterPillGroup } from "./filter-pills";
export { ContextBar } from "./context-bar";
```

**Background consistency:**
- Dashboard container should have bg-[#0A0A0A] or bg-background
- Ensure no white flash on load
  </action>
  <verify>
1. Visit /dashboard
2. Animated dots visible
3. "Switzerland" label at top left
4. Filter pills at top right
5. Clicking pills toggles their state
6. Layout is responsive (fills available space)
7. Build passes
  </verify>
  <done>
- Dashboard page shows complete layout
- Network visualization animates
- Context bar and filter pills positioned correctly
- All components exported from barrel
  </done>
</task>

</tasks>

<verification>
1. /dashboard shows animated dot visualization
2. Context bar displays "Switzerland" at top
3. Filter pills show 4 role levels with colors
4. Clicking pills toggles active state
5. Animation respects prefers-reduced-motion
6. No console errors
7. Build passes
</verification>

<success_criteria>
- Network visualization renders animated dots with role-level colors
- Context bar shows location label
- Filter pills are interactive (toggle state)
- Dashboard page layout matches reference
- Accessibility: sr-only heading, reduced motion support
</success_criteria>

<output>
After completion, create `.planning/phases/04-app-layout-navigation/04-04-SUMMARY.md`
</output>
