---
phase: 05-referrals-brand-deals
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/(app)/referrals/page.tsx
  - src/components/referral/ReferralLinkCard.tsx
  - src/components/referral/ReferralStatsCard.tsx
  - src/components/referral/ReferralsUpgradeFallback.tsx
  - src/app/(app)/brand-deals/page.tsx
autonomous: true

must_haves:
  truths:
    - "Referrals page cards use brand design tokens (border-white/[0.06], 12px radius, inset shadow) consistently"
    - "ReferralsUpgradeFallback uses design tokens (text-foreground-muted, bg-accent) not hardcoded colors"
    - "Brand deals page renders a real page with Virtuna affiliate info and a coming-soon section for brand deals"
    - "Brand deals page does NOT redirect to referrals"
    - "Both /referrals and /brand-deals routes load without errors"
  artifacts:
    - path: "src/app/(app)/brand-deals/page.tsx"
      provides: "Brand deals page with affiliate info and coming-soon section"
      min_lines: 25
    - path: "src/components/referral/ReferralsUpgradeFallback.tsx"
      provides: "Brand-aligned upgrade fallback"
      contains: "bg-accent"
    - path: "src/components/referral/ReferralLinkCard.tsx"
      provides: "Brand-aligned referral link card"
    - path: "src/components/referral/ReferralStatsCard.tsx"
      provides: "Brand-aligned referral stats card"
  key_links:
    - from: "src/app/(app)/brand-deals/page.tsx"
      to: "rendered page"
      via: "Next.js route"
      pattern: "export default"
---

<objective>
Polish referrals page UI for brand consistency and replace the dead brand-deals redirect with a proper page showing Virtuna's affiliate program info and a "brand deals coming soon" section.

Purpose: Eliminate the last dead redirect in the app (brand-deals -> referrals) and ensure referrals UI matches the Raycast design language used throughout the platform.
Output: Polished referrals page + new brand deals page with affiliate info and coming-soon placeholder.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/app/(app)/referrals/page.tsx
@src/components/referral/ReferralLinkCard.tsx
@src/components/referral/ReferralStatsCard.tsx
@src/components/referral/ReferralsUpgradeFallback.tsx
@src/components/referral/CopyButton.tsx
@src/app/(app)/brand-deals/page.tsx
@src/components/app/settings/team-section.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Polish referrals page and component brand alignment</name>
  <files>
    src/app/(app)/referrals/page.tsx
    src/components/referral/ReferralLinkCard.tsx
    src/components/referral/ReferralStatsCard.tsx
    src/components/referral/ReferralsUpgradeFallback.tsx
  </files>
  <action>
Polish the referrals page and its components to match brand design language:

**ReferralsUpgradeFallback.tsx** — Replace hardcoded colors with design tokens:
- `text-zinc-400` → `text-foreground-muted`
- `bg-[#FF7F50]` → `bg-accent` (coral is already the accent token)
- `hover:bg-[#FF7F50]/90` → `hover:bg-accent/90`
- `text-white` on the button → `text-accent-foreground` (dark brown #1a0f0a, per brand bible AAA contrast)
- The icon container `bg-[#FF7F50]/10` → `bg-accent/10`
- `text-[#FF7F50]` → `text-accent`
- Card: ensure it uses `rounded-xl border border-white/[0.06]` (currently `rounded-lg` — update to `rounded-xl` for 12px consistency)
- Add inset shadow: `shadow-[inset_0_1px_0_0_rgba(255,255,255,0.05)]`

**ReferralLinkCard.tsx** — Already mostly correct. Verify/update:
- Card already has correct `rounded-[12px] border border-white/[0.06]` and inset shadow — good
- Inner code display box: `bg-white/[0.03]` is fine
- No changes needed unless tokens are off

**ReferralStatsCard.tsx** — Already mostly correct. Verify/update:
- Card already has correct border and shadow — good
- `text-coral` on earnings → verify this maps to `text-accent` token. If `text-coral` isn't a design token, replace with `text-accent`
- Stat boxes already use `bg-white/[0.02] border border-white/[0.05]` — good

**referrals/page.tsx** — No structural changes needed. The server component is well-structured with proper Supabase queries and FeatureGate. Leave as-is.

Do NOT change any Supabase logic, FeatureGate behavior, or component API surface. This is purely visual polish.
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm no type errors. Visually inspect that no hardcoded hex colors remain in the referral components (grep for `#FF7F50`, `zinc-`, `text-white` in referral components).
  </verify>
  <done>
All referral components use design tokens exclusively (no hardcoded hex colors or zinc palette). Cards have consistent 12px radius, 6% borders, and inset shadows matching the rest of the app.
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace brand deals redirect with proper page</name>
  <files>
    src/app/(app)/brand-deals/page.tsx
  </files>
  <action>
Replace the dead redirect in `src/app/(app)/brand-deals/page.tsx` with a proper page. The page should be a server component (no "use client" needed) with two sections:

**Page structure:**

1. **Page header** — same pattern as referrals page:
   - `max-w-4xl mx-auto px-4 py-6 sm:p-6 space-y-6` wrapper
   - `h1` with `text-3xl font-bold text-foreground mb-2`: "Brand Deals"
   - `p` with `text-muted`: "Connect with brands and monetize your content through partnerships."

2. **Virtuna Affiliate section** — a card (same styling as referral cards):
   - `rounded-xl border border-white/[0.06] p-4 sm:p-6 space-y-4 shadow-[inset_0_1px_0_0_rgba(255,255,255,0.05)]`
   - Heading: "Virtuna Affiliate Program"
   - Description: "Earn $10 for every creator you refer to Virtuna. Share your referral link and track conversions."
   - A Link button to `/referrals`: "Go to Referral Program →" styled as primary button (`bg-white text-gray-950 rounded-lg px-4 py-2 text-sm font-medium hover:bg-white/90 transition-colors`)

3. **Brand Deals Coming Soon section** — same pattern as settings team-section:
   - `flex flex-col items-center justify-center rounded-xl border border-dashed border-white/[0.06] px-6 py-16 text-center`
   - Lucide `Handshake` icon (import from lucide-react), `h-12 w-12 text-foreground-muted`
   - Heading: "Brand Deal Marketplace"
   - Description: "Browse brand partnerships, apply to campaigns, and manage your collaborations — all in one place. Coming soon."

**Metadata:** Add `export const metadata: Metadata = { title: "Brand Deals | Virtuna", description: "Connect with brands and monetize your content." }`

**Imports:** `import type { Metadata } from "next"`, `import Link from "next/link"`, `import { Handshake } from "lucide-react"`

Remove the `redirect` import and the redirect call entirely. This page should render content, not redirect.
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm no type errors. Navigate to `/brand-deals` and verify it renders a full page (not a redirect). Check that the page has the affiliate card with link to referrals and the coming-soon section.
  </verify>
  <done>
Brand deals page renders a proper page with Virtuna affiliate info card (linking to referrals) and a "brand deals coming soon" dashed-border placeholder section. No redirect remains.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `grep -r '#FF7F50\|zinc-' src/components/referral/` returns no matches (all design tokens)
3. `/referrals` route loads and displays referral link + stats cards with consistent styling
4. `/brand-deals` route loads a real page (no redirect) with affiliate info and coming-soon section
5. Sidebar "Referrals" navigation still works correctly
</verification>

<success_criteria>
- Referrals page components use design tokens exclusively (no hardcoded colors)
- Brand deals page is a real rendered page with two sections (affiliate card + coming-soon)
- Dead redirect from brand-deals to referrals is eliminated
- All three requirements (REF-01, REF-02, REF-03) are satisfied
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/05-referrals-brand-deals/05-01-SUMMARY.md`
</output>
