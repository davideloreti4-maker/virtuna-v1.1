---
phase: 08-results-card-breakdown-ui
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/app/simulation/behavioral-predictions.tsx
  - src/components/app/simulation/insights-section.tsx
autonomous: true

must_haves:
  truths:
    - "4 stat cards (completion %, share %, comment %, save %) display as horizontal row on desktop and 2x2 grid on narrow screens"
    - "Suggestions display as after-only cards with effort tags (Quick Win / Medium / Major) and category context"
    - "All suggestions are visible — no collapse/show-more"
  artifacts:
    - path: "src/components/app/simulation/behavioral-predictions.tsx"
      provides: "Behavioral predictions stat cards with percentile context"
      contains: "behavioral_predictions"
    - path: "src/components/app/simulation/insights-section.tsx"
      provides: "After-only suggestions with effort tags"
      contains: "improvement_tip\\|Quick Win\\|Medium\\|Major"
  key_links:
    - from: "src/components/app/simulation/behavioral-predictions.tsx"
      to: "BehavioralPredictions"
      via: "behavioral_predictions prop from PredictionResult"
      pattern: "completion_pct.*share_pct"
    - from: "src/components/app/simulation/insights-section.tsx"
      to: "Suggestion[]"
      via: "suggestions prop from PredictionResult"
      pattern: "category.*priority.*text"
---

<objective>
Create behavioral predictions stat cards and rewrite suggestions display for v2 results.

Purpose: Show users concrete behavioral predictions (completion %, share %, comment %, save %) as scannable stat cards, and display AI suggestions in after-only format with effort tags for actionability.

Output: New BehavioralPredictions component and rewritten InsightsSection (now SuggestionsSection) using v2 data shapes.
</objective>

<execution_context>
@/Users/davideloreti/.claude/get-shit-done/workflows/execute-plan.md
@/Users/davideloreti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-results-card-breakdown-ui/08-CONTEXT.md
@src/lib/engine/types.ts
@src/components/app/simulation/insights-section.tsx
@src/components/primitives/GlassProgress.tsx
@src/components/ui/card.tsx
@src/components/ui/badge.tsx
@src/components/ui/typography.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create BehavioralPredictions stat cards component</name>
  <files>src/components/app/simulation/behavioral-predictions.tsx</files>
  <action>
Create new file `src/components/app/simulation/behavioral-predictions.tsx`.

Props interface:
```typescript
interface BehavioralPredictionsProps {
  predictions: BehavioralPredictions; // from @/lib/engine/types
}
```

Layout (per LOCKED decisions: "Stat cards in a horizontal row"):
1. Section header: "Predicted Behavior" in Text size="sm" muted, with Info icon
2. Grid container: `grid grid-cols-2 lg:grid-cols-4 gap-3` (2x2 on narrow, 4 across on desktop per LOCKED decision)
3. Four stat cards, each a GlassCard with padding via className "p-3":
   - **Completion**: label "Completion", value `predictions.completion_pct`, percentile `predictions.completion_percentile`
   - **Shares**: label "Share Rate", value `predictions.share_pct`, percentile `predictions.share_percentile`
   - **Comments**: label "Comment Rate", value `predictions.comment_pct`, percentile `predictions.comment_percentile`
   - **Saves**: label "Save Rate", value `predictions.save_pct`, percentile `predictions.save_percentile`
4. Each stat card layout (vertical stack):
   - Metric name: Text size="xs" muted (e.g., "Completion")
   - Percentage value: `text-2xl font-bold text-foreground` with "%" suffix
   - Percentile context below: Text size="xs" muted showing percentile string (e.g., "Top 25%" or the raw percentile string from API)
   - Small GlassProgress bar at bottom: `value={pct}` size="sm" color="coral"
5. Wrap everything in a single outer div (no outer GlassCard — the individual stat cards ARE the glass cards)

Import `BehavioralPredictions` type from `@/lib/engine/types`. Import `GlassCard` from `@/components/ui/card`, `Text` from `@/components/ui/typography`, `GlassProgress` from `@/components/primitives`, `Info` from `lucide-react`.

Add `'use client';` directive at top.
  </action>
  <verify>Run `npx tsc --noEmit --pretty src/components/app/simulation/behavioral-predictions.tsx 2>&1 | head -20` — should compile without errors</verify>
  <done>BehavioralPredictions renders 4 responsive stat cards with percentage values, percentile context, and progress bars</done>
</task>

<task type="auto">
  <name>Task 2: Rewrite InsightsSection to SuggestionsSection with effort tags</name>
  <files>src/components/app/simulation/insights-section.tsx</files>
  <action>
Rewrite InsightsSection completely. Rename the exported component to `SuggestionsSection` (keep file name `insights-section.tsx` to minimize import changes in Plan 3).

Props interface:
```typescript
interface SuggestionsSectionProps {
  suggestions: Suggestion[];  // from @/lib/engine/types
}
```

Layout (per LOCKED decisions):
1. Section header: "Suggestions" with Info icon
2. All suggestions visible — no "show more" collapse (LOCKED decision)
3. Map effort tags from suggestion priority (LOCKED decision: Quick Win / Medium / Major):
   - priority "high" → "Quick Win" (Badge variant="success" size="sm")
   - priority "medium" → "Medium" (Badge variant="warning" size="sm")
   - priority "low" → "Major" (Badge variant="default" size="sm")
4. Each suggestion as an individual card-like row inside the GlassCard:
   - Top row: category label (Text size="xs" muted, uppercased) + effort tag Badge on the right
   - Body: suggestion text (Text size="sm" leading-relaxed)
   - "After only with context" format (LOCKED decision): the `text` field IS the improved version. Show it as the main content. No before/after split needed since the API `text` field already contains the actionable suggestion with context.
   - Subtle separator between suggestions: `border-b border-border last:border-b-0` on each item div, with `py-3 first:pt-0 last:pb-0` for spacing
5. Wrap in GlassCard padding="md" blur="none"

Remove old InsightsSection logic (string[] insights, accordion, getInsightSummary). Import `Suggestion` from `@/lib/engine/types`, `Badge` from `@/components/ui/badge`.
  </action>
  <verify>Run `npx tsc --noEmit --pretty src/components/app/simulation/insights-section.tsx 2>&1 | head -20` — should compile without errors</verify>
  <done>SuggestionsSection renders all suggestions with effort tags, categories, and after-only format using v2 Suggestion[] data</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` on both files compiles without errors
- BehavioralPredictions accepts `predictions: BehavioralPredictions` from engine types
- SuggestionsSection accepts `suggestions: Suggestion[]` from engine types
- No v1 types imported (no string[] insights, no accordion for insights)
- Responsive grid works (2-col on mobile, 4-col on lg)
</verification>

<success_criteria>
1. Behavioral predictions show as 4 stat cards (completion, share, comment, save) with percentages and percentile context
2. Suggestions display in after-only format with effort tags (Quick Win / Medium / Major)
3. All suggestions visible without collapse
4. Responsive layout: 4 across on desktop, 2x2 on narrow
</success_criteria>

<output>
After completion, create `.planning/phases/08-results-card-breakdown-ui/08-02-SUMMARY.md`
</output>
